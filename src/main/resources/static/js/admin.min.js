(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["admin"],{"066d":function(e,t,n){"use strict";n("9133")},"0952":function(e,t,n){"use strict";n("6eea")},"0ae0":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-card",{staticClass:"zfile-admin-short-card"},[n("el-form",{staticClass:"zfile-admin-short-form",attrs:{inline:!0,model:e.searchParam}},[n("el-form-item",{attrs:{label:"直链 Key"}},[n("el-input",{attrs:{size:"small"},model:{value:e.searchParam.key,callback:function(t){e.$set(e.searchParam,"key",t)},expression:"searchParam.key"}})],1),n("el-form-item",{attrs:{label:"路径/文件名"}},[n("el-input",{attrs:{size:"small"},model:{value:e.searchParam.url,callback:function(t){e.$set(e.searchParam,"url",t)},expression:"searchParam.url"}})],1),n("el-form-item",{attrs:{label:"创建日期"}},[n("el-date-picker",{attrs:{type:"daterange",align:"right","unlink-panels":"","value-format":"yyyy-MM-dd","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},on:{change:e.dateChange},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:e.init}},[e._v("查询")])],1)],1),n("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:e.openAddLinkItemDialog}},[e._v("新增直链")]),n("el-button",{attrs:{type:"danger",size:"small",icon:"el-icon-delete"},on:{click:e.batchDeleteLinkItem}},[e._v("删除所选")]),n("el-table",{ref:"shortLinkTable",attrs:{data:e.linkLog,"default-sort":{prop:"createDate",order:"descending"}},on:{"row-click":e.handleRowClick,"sort-change":e.sortMethod}},[n("el-table-column",{attrs:{type:"selection",label:"序号"}}),n("el-table-column",{attrs:{type:"index",label:"序号"}}),n("el-table-column",{attrs:{prop:"key","show-overflow-tooltip":!0,width:"100",sortable:"custom","sort-orders":["ascending","descending"],label:"Key"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("a",{attrs:{target:"_blank",href:e.siteDomain+"/s/"+t.row.key}},[e._v(e._s(t.row.key))]),n("i",{staticClass:"el-icon-edit-outline table-edit-icon",on:{click:function(n){return e.editKey(t.row.id)}}})]}}])}),n("el-table-column",{attrs:{prop:"url","show-overflow-tooltip":!0,sortable:"custom","sort-orders":["ascending","descending"],label:"路径"}}),n("el-table-column",{attrs:{prop:"createDate",width:"150",sortable:"custom","sort-orders":["ascending","descending"],label:"创建日期"}}),n("el-table-column",{attrs:{width:"120",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-popconfirm",{attrs:{confirmButtonText:"确定",cancelButtonText:"取消",icon:"el-icon-info",iconColor:"red",title:"确定删除此直链"},on:{confirm:function(n){return e.deleteLink(t.row.id)}}},[n("el-button",{staticClass:"el-icon-delete",attrs:{slot:"reference",size:"mini",type:"danger"},slot:"reference"},[e._v("删除")])],1)]}}])})],1),n("el-pagination",{attrs:{background:"","current-page":e.searchParam.page,"page-sizes":[10,50,100,200,999999],layout:"total, sizes, prev, pager, next, jumper","page-size":e.searchParam.limit,total:e.searchParam.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e.addLinkVisible?n("el-dialog",{attrs:{id:"cacheDialog",width:"50%",title:"直链管理","modal-append-to-body":!1,visible:e.addLinkVisible},on:{"update:visible":function(t){e.addLinkVisible=t}}},[n("el-form",{attrs:{model:e.addLinkModel,"label-width":"150px"}},[n("el-form-item",{attrs:{label:"驱动器 ID"}},[n("el-select",{attrs:{placeholder:"请选择驱动器"},model:{value:e.addLinkModel.driveId,callback:function(t){e.$set(e.addLinkModel,"driveId",t)},expression:"addLinkModel.driveId"}},e._l(e.driveList,(function(t){return n("el-option",{key:t.id,attrs:{label:t.name,value:t.id}},[n("span",{staticStyle:{float:"left"}},[e._v(e._s(t.name))]),n("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.id))])])})),1)],1),n("el-form-item",{attrs:{label:"路径"}},[n("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入路径地址"},model:{value:e.addLinkModel.path,callback:function(t){e.$set(e.addLinkModel,"path",t)},expression:"addLinkModel.path"}},[n("div",{attrs:{slot:"prepend"},slot:"prepend"},[e._v("/directlink/"+e._s(e.addLinkModel.driveId))])])],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary",icon:"el-icon-check",size:"small"},on:{click:e.addLinkItemAction}},[e._v("保存")]),n("el-button",{attrs:{icon:"el-icon-close",size:"small"},on:{click:function(t){e.addLinkVisible=!1}}},[e._v("关闭")])],1)],1):e._e()],1)},i=[],o={name:"ShortLink",data:function(){return{addLinkModel:{driveId:null,path:""},addLinkVisible:!1,linkUrl:"",linkLog:[],searchParam:{page:1,limit:10,total:0,url:"",key:"",orderBy:"",orderDirection:""},pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,n=new Date;n.setTime(n.getTime()-6048e5),e.$emit("pick",[n,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,n=new Date;n.setTime(n.getTime()-2592e6),e.$emit("pick",[n,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,n=new Date;n.setTime(n.getTime()-7776e6),e.$emit("pick",[n,t])}}]},date:["",""],driveList:[],siteDomain:""}},methods:{editKey:function(e){var t=this;this.$prompt("请输入要修改为的 Key。","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(n){var a=n.value;t.$http.get("admin/api/short-link/key",{params:{id:e,newKey:a}}).then((function(){t.$message({message:"修改成功",type:"success"}),t.init()}))}))},handleRowClick:function(e){this.$refs.shortLinkTable.toggleRowSelection(e)},batchDeleteLinkItem:function(){var e=this,t=this.$refs.shortLinkTable.selection;0!==t.length?this.$confirm("删除后不可恢复, 是否确认删除","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",callback:function(n){if("confirm"===n){var a=[];for(var i in t)a[i]=t[i].id;e.$http.delete("admin/api/short-link",{params:{id:a}}).then((function(t){0===t.data.code?(e.$message.success("删除成功"),e.init()):e.$message.error(t.data.msg)}))}}}):this.$message.warning("请至少选中一行数据")},addLinkItemAction:function(){var e=this;alert(this.$store.getters.domain),this.addLinkModel.path=this.common.removeDuplicateSeparator("/"+this.addLinkModel.path),this.$http.get("api/short-link",{params:this.addLinkModel}).then((function(){e.$message.success("添加成功"),e.init(),e.addLinkVisible=!1}))},openAddLinkItemDialog:function(){this.addLinkVisible=!0},dateChange:function(){this.date?(this.searchParam.dateFrom=this.date[0],this.searchParam.dateTo=this.date[1]):(this.searchParam.dateFrom="",this.searchParam.dateTo="")},sortMethod:function(e){var t=e.prop,n=e.order;this.searchParam.orderBy=t,this.searchParam.orderDirection="descending"===n?"desc":"asc",this.init()},handleSizeChange:function(e){this.searchParam.limit=e,this.searchParam.page=1,this.init()},handleCurrentChange:function(e){this.searchParam.page=e,this.init()},deleteLink:function(e){var t=this;this.$http.get("admin/link/delete/".concat(e)).then((function(e){e.data.code===t.common.responseCode.SUCCESS?(t.$message.success("删除成功"),t.init()):t.$message.error(e.data.msg)}))},init:function(){var e=this;this.$http.get("admin/link/list",{params:this.searchParam}).then((function(t){e.linkLog=t.data.data.content,e.searchParam.total=t.data.data.totalElements,e.searchParam.limit=t.data.data.size}))},loadDriveList:function(){var e=this;this.$http.get("api/drive/list").then((function(t){e.driveList=t.data.data}))},getDomainId:function(){var e=this;this.$http.get("admin/config").then((function(t){e.siteDomain=t.data.data.domain}))}},mounted:function(){this.init(),this.loadDriveList(),this.getDomainId()}},r=o,s=(n("0952"),n("5d22")),l=Object(s["a"])(r,a,i,!1,null,"1513b0ea",null);t["default"]=l.exports},"121e":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-card",{attrs:{shadow:"false"}},[n("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{id:"siteForm","element-loading-text":"保存中...",rules:e.rules,model:e.form,"label-width":"auto","status-icon":!0}},[n("el-form-item",{staticClass:"box animate__animated animate__fadeInUp",attrs:{label:"站点名称",prop:"siteName"}},[n("el-input",{model:{value:e.form.siteName,callback:function(t){e.$set(e.form,"siteName",t)},expression:"form.siteName"}})],1),n("el-form-item",{staticClass:"box animate__animated animate__fadeInUp",attrs:{label:"站点域名",prop:"domain"}},[n("el-input",{model:{value:e.form.domain,callback:function(t){e.$set(e.form,"domain",t)},expression:"form.domain"}}),n("div",{staticClass:"zfile-word-aux zfile-margin-left-unset"},[e._v("此地址用于生成直链及本次存储下载使用，请务必保持和服务端地址一样。")])],1),n("el-form-item",{staticClass:"box animate__animated animate__fadeInUp"},[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.submitForm("form")}}},[e._v("保存设置")])],1)],1)],1)},i=[],o=n("fed1"),r=n.n(o),s={name:"SiteSetting",data:function(){return{form:{siteName:"",domain:""},loading:!1,rules:{siteName:[{required:!0,message:"请输入站点名称",trigger:"change"}],domain:[{required:!0,type:"url",message:"请输入正确的域名，需以 http:// 或 https:// 开头",trigger:"change"}]}}},methods:{submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.loading=!0,t.$http.post("admin/config",r.a.stringify(t.form)).then((function(e){t.loading=!1,e.data.code===t.common.responseCode.SUCCESS?t.$message({message:"保存成功",type:"success"}):t.$message({message:e.data.msg,type:"error"})}))}))}},mounted:function(){var e=this;this.$http.get("admin/config").then((function(t){e.form=t.data.data;var n=""===e.$http.defaults.baseURL?window.location.origin:e.$http.defaults.baseURL,a=e.form.domain;n!==a&&e.$confirm("检测到服务端地址为 ".concat(n,"，当前配置站点域名为 ").concat(a,"，是否自动进行修正（不修正可能会影响下载、文件夹加密和文档预览功能）？"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",callback:function(t){"confirm"===t&&(e.form.domain=n,e.$http.post("admin/config",r.a.stringify(e.form)).then((function(t){e.loading=!1,t.data.code===e.common.responseCode.SUCCESS?e.$message({message:"修正成功",type:"success"}):e.$message({message:t.data.msg,type:"error"})})))}})}))}},l=s,c=(n("4b7f"),n("5d22")),d=Object(c["a"])(l,a,i,!1,null,"875b6660",null);t["default"]=d.exports},"1e78":function(e,t,n){},2067:function(e,t,n){"use strict";n("f10e")},3823:function(e,t,n){"use strict";n("c8c5")},"432e":function(e,t,n){"use strict";n("4407")},4407:function(e,t,n){},"4b7f":function(e,t,n){"use strict";n("8166")},"50b8":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:12,offset:6}},[n("h2",[e._v("在线获取 SharePoint SiteId 小工具")]),n("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form}},[n("el-form-item",{staticClass:"box animate__animated animate__fadeInUp",attrs:{label:"版本"}},[n("el-radio",{attrs:{label:"Standard"},on:{change:e.changeType},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[e._v("国际版")]),n("el-radio",{attrs:{label:"China"},on:{change:e.changeType},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[e._v("世纪互联")])],1),n("el-form-item",{staticClass:"box animate__animated animate__fadeInUp",attrs:{label:"AccessToken",prop:"accessToken"}},[n("el-input",{attrs:{placeholder:"请输入 AccessToken"},model:{value:e.form.accessToken,callback:function(t){e.$set(e.form,"accessToken",t)},expression:"form.accessToken"}}),n("el-link",{directives:[{name:"show",rawName:"v-show",value:"Standard"===e.form.type,expression:"form.type === 'Standard'"}],attrs:{target:"_blank",icon:"el-icon-link",href:e.$http.defaults.baseURL+"/onedrive/authorize"}},[e._v("前往获取令牌 (国际版)")]),n("el-link",{directives:[{name:"show",rawName:"v-show",value:"China"===e.form.type,expression:"form.type === 'China'"}],attrs:{target:"_blank",icon:"el-icon-link",href:e.$http.defaults.baseURL+"/onedrive/china-authorize"}},[e._v("前往获取令牌 (世纪互联)")])],1),n("el-form-item",{staticClass:"box animate__animated animate__fadeInUp",attrs:{label:"SharePoint 域名",prop:"domainPrefix"}},[n("el-input",{attrs:{placeholder:"请输入 SharePoint 域名"},model:{value:e.form.domainPrefix,callback:function(t){e.$set(e.form,"domainPrefix",t)},expression:"form.domainPrefix"}},[n("template",{slot:"append"},[e._v(".sharepoint."+e._s(e.form.domainType))])],2)],1),n("el-form-item",{staticClass:"box animate__animated animate__fadeInUp",attrs:{label:"站点名称",prop:"siteName"}},[n("template",{slot:"label"},[n("span",[e._v("站点名称")]),n("span",{staticClass:"zfile-word-aux"},[e._v("（网址上域名后面的 /sites/xxx 或/teams/xxx）")])]),n("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入站点名称"},on:{input:function(t){return e.submitForm("form")}},model:{value:e.form.siteName,callback:function(t){e.$set(e.form,"siteName",t)},expression:"form.siteName"}},[n("el-select",{attrs:{slot:"prepend"},on:{input:function(t){return e.change(t)}},slot:"prepend",model:{value:e.form.siteType,callback:function(t){e.$set(e.form,"siteType",t)},expression:"form.siteType"}},[n("el-option",{attrs:{label:"/sites/",value:"/sites/"}}),n("el-option",{attrs:{label:"/teams/",value:"/teams/"}})],1)],1)],2),n("el-form-item",{staticClass:"box animate__animated animate__fadeInUp",attrs:{label:"SiteID"}},[n("el-input",{attrs:{type:"small"},model:{value:e.siteId,callback:function(t){e.siteId=t},expression:"siteId"}},[n("el-tooltip",{staticClass:"item",attrs:{slot:"append",effect:"dark",content:"复制",placement:"bottom"},slot:"append"},[n("el-button",{attrs:{type:"small",icon:"el-icon-copy-document"},on:{click:function(t){return e.copyText(e.siteId)}}})],1)],1)],1)],1)],1)],1)},i=[],o={name:"SharePointSiteId",data:function(){return{form:{type:"Standard",accessToken:"",domainPrefix:"",siteType:"/sites/",siteName:"",domainType:"com"},siteId:"",rules:{accessToken:[{required:!0,message:"AccessToken 不能为空",trigger:"change"}],domainPrefix:[{required:!0,message:"SharePoint 域名不能为空",trigger:"change"}],siteName:[{required:!0,message:"站点名称不能为空",trigger:"change"}]},loading:!1}},watch:{"form.type":function(){this.form.accessToken&&this.getDomainPrefix()},"form.accessToken":function(){this.form.accessToken&&this.getDomainPrefix()}},methods:{getDomainPrefix:function(){var e=this;this.$http.post("/sharepoint/getDomainPrefix",this.form).then((function(t){t.data.code===e.common.responseCode.SUCCESS&&(e.form.domainPrefix=t.data.data)}))},copyText:function(e){var t=this;this.$copyText(e).then((function(){t.$message.success("复制成功")}),(function(){t.$message.error("复制失败")}))},changeType:function(){"Standard"===this.form.type?this.form.domainType="com":"China"===this.form.type&&(this.form.domainType="cn")},change:function(){this.$forceUpdate()},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return t.loading=!1,!1;t.loading=!0,t.$http.post("/sharepoint/getSiteId",t.form).then((function(e){e.data.code===t.common.responseCode.SUCCESS&&(t.siteId=e.data.data,t.$forceUpdate(),t.$message.success("自动获取 SiteId 成功")),t.loading=!1}))}))}}},r=o,s=(n("5904"),n("5d22")),l=Object(s["a"])(r,a,i,!1,null,"3ac09bd8",null);t["default"]=l.exports},"578a":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"zfile-login"},[n("el-form",{ref:"loginForm",staticClass:"zfile-login-form",attrs:{model:e.loginForm,rules:e.rules,"status-icon":""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSubmit(t)}}},[n("div",{staticClass:"zfile-login-title box animate__animated animate__fadeIn"},[e._v("\n            Z-File\n            "),n("small",[e._v("Admin")])]),n("el-form-item",{staticClass:"box animate__animated animate__fadeInUp",attrs:{prop:"username"}},[n("el-input",{attrs:{type:"text","prefix-icon":"el-icon-user","auto-complete":"off",placeholder:"用户名"},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username","string"===typeof t?t.trim():t)},expression:"loginForm.username"}})],1),n("el-form-item",{staticClass:"box animate__animated animate__fadeInUp",attrs:{prop:"password"}},[n("el-input",{attrs:{type:"password","prefix-icon":"el-icon-key","auto-complete":"off",placeholder:"密码"},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password","string"===typeof t?t.trim():t)},expression:"loginForm.password"}})],1),n("el-form-item",[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[n("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n                    将配置文件 application.properties 中 zfile.debug 修改为 true, 访问首页即可重置 "),n("br"),e._v("\n                    点击可前往文档查看操作方式\n                ")]),n("el-link",{staticClass:"zfile-float-right",attrs:{icon:"el-icon-question",underline:!1},on:{click:e.openResetPwdDocs}},[e._v("忘记密码")])],1)],1),n("el-form-item",[n("el-button",{staticClass:"el-col-24",attrs:{type:"primary",loading:e.loading},on:{click:e.handleSubmit}},[e._v("登录\n            ")])],1)],1)],1)},i=[],o=n("fed1"),r=n.n(o),s={name:"Login",data:function(){return{loading:!1,loginForm:{},rules:{username:[{required:!0,message:"账号不能为空",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"}]}}},mounted:function(){var e=this;this.$http.get("is-installed").then((function(t){var n=t.data;0===n.code&&e.$router.push("/install")})),document.title="登录 | 后台管理"},methods:{openResetPwdDocs:function(){window.open("http://docs.zhaojun.im/zfile/#/question?id=reset-pwd")},handleSubmit:function(){var e=this;this.$refs.loginForm.validate((function(t){if(!t)return!1;e.$http.post("login",r.a.stringify(e.loginForm)).then((function(t){e.$message({message:t.data.msg,type:"success",duration:1e3,onClose:function(){e.$router.push("/admin")}})}))}))}}},l=s,c=(n("2067"),n("5d22")),d=Object(c["a"])(l,a,i,!1,null,"085cced0",null);t["default"]=d.exports},5904:function(e,t,n){"use strict";n("e90a")},"615b":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-card",{attrs:{shadow:"false"}},[n("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{id:"siteForm","element-loading-text":"保存中...",model:e.form,"label-width":"auto","status-icon":!0}},[n("el-form-item",{staticClass:"box animate__animated animate__fadeInUp",attrs:{label:"页面布局"}},[n("el-radio",{attrs:{label:"full"},model:{value:e.form.layout,callback:function(t){e.$set(e.form,"layout",t)},expression:"form.layout"}},[e._v("全屏")]),n("el-radio",{attrs:{label:"center"},model:{value:e.form.layout,callback:function(t){e.$set(e.form,"layout",t)},expression:"form.layout"}},[e._v("居中")])],1),n("el-form-item",{staticClass:"box animate__animated animate__fadeInUp",attrs:{label:"列表尺寸"}},[n("el-radio",{attrs:{label:"medium"},model:{value:e.form.tableSize,callback:function(t){e.$set(e.form,"tableSize",t)},expression:"form.tableSize"}},[e._v("大")]),n("el-radio",{attrs:{label:"small"},model:{value:e.form.tableSize,callback:function(t){e.$set(e.form,"tableSize",t)},expression:"form.tableSize"}},[e._v("中")]),n("el-radio",{attrs:{label:"mini"},model:{value:e.form.tableSize,callback:function(t){e.$set(e.form,"tableSize",t)},expression:"form.tableSize"}},[e._v("小")])],1),n("el-form-item",{staticClass:"box animate__animated animate__fadeInUp",attrs:{label:"显示操作按钮"}},[n("el-switch",{model:{value:e.form.showOperator,callback:function(t){e.$set(e.form,"showOperator",t)},expression:"form.showOperator"}}),n("el-tooltip",{attrs:{placement:"right"}},[n("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n                    显示下载和复制按钮, 在移动端只显示下载\n                ")]),n("i",{staticClass:"el-icon-info zfile-info-tooltip"})])],1),n("el-form-item",{staticClass:"box animate__animated animate__fadeInUp",attrs:{label:"显示文档区"}},[n("el-switch",{model:{value:e.form.showDocument,callback:function(t){e.$set(e.form,"showDocument",t)},expression:"form.showDocument"}}),n("el-tooltip",{attrs:{placement:"right"}},[n("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n                    在文件列表下，显示当前文件夹中 readme.md 的内容，支持 md 和 html 语法\n                ")]),n("i",{staticClass:"el-icon-info zfile-info-tooltip"})])],1),n("el-form-item",{staticClass:"box animate__animated animate__fadeInUp",attrs:{label:"显示公告"}},[n("el-switch",{model:{value:e.form.showAnnouncement,callback:function(t){e.$set(e.form,"showAnnouncement",t)},expression:"form.showAnnouncement"}}),n("el-tooltip",{attrs:{placement:"right"}},[n("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n                    网站顶部，显示公告内容，支持 HTML 语法\n                ")]),n("i",{staticClass:"el-icon-info zfile-info-tooltip"})])],1),n("el-form-item",{staticClass:"box animate__animated animate__fadeInUp",attrs:{label:"公告内容"}},[n("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入公告内容"},model:{value:e.form.announcement,callback:function(t){e.$set(e.form,"announcement",t)},expression:"form.announcement"}})],1),n("el-form-item",{staticClass:"box animate__animated animate__fadeInUp",attrs:{label:"自定义 CSS"}},[n("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入自定义 CSS 内容"},model:{value:e.form.customCss,callback:function(t){e.$set(e.form,"customCss",t)},expression:"form.customCss"}})],1),n("el-form-item",{staticClass:"box animate__animated animate__fadeInUp",attrs:{label:"自定义 JS"}},[n("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入自定义 JS 内容"},model:{value:e.form.customJs,callback:function(t){e.$set(e.form,"customJs",t)},expression:"form.customJs"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary",round:""},on:{click:function(t){return e.submitForm("form")}}},[e._v("保存设置")])],1)],1)],1)},i=[],o=n("fed1"),r=n.n(o),s={name:"ViewSetting",data:function(){return{form:{layout:"",tableSize:"",showOperator:!1,showDocument:!1,showAnnouncement:!1,announcement:"",customCss:"",customJs:""},loading:!1}},methods:{submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.loading=!0,t.$http.post("admin/config",r.a.stringify(t.form)).then((function(e){t.loading=!1,e.data.code===t.common.responseCode.SUCCESS&&t.$message({message:"保存成功",type:"success"})}))}))}},mounted:function(){var e=this;this.$http.get("admin/config").then((function(t){e.form=t.data.data}))}},l=s,c=n("5d22"),d=Object(c["a"])(l,a,i,!1,null,"570a4a55",null);t["default"]=d.exports},"6aec":function(e,t,n){},"6eea":function(e,t,n){},8166:function(e,t,n){},"8d1d":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-card",[n("div",[n("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini"},on:{click:e.addDrive}},[e._v("新增")]),n("span",{staticClass:"zfile-word-aux"},[e._v("提示：拖拽行可以进行排序")])],1),n("el-table",{ref:"driveTable",attrs:{data:e.driveList,"row-key":"id","highlight-current-row":""}},[n("el-table-column",{attrs:{prop:"id",align:"center",width:"100",label:"驱动器ID"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.id))]),n("i",{staticClass:"el-icon-edit-outline table-edit-icon",on:{click:function(n){return e.editDriveId(t.row.id)}}})]}}])}),n("el-table-column",{attrs:{prop:"name","show-overflow-tooltip":!0,label:"驱动器名称"}}),n("el-table-column",{attrs:{prop:"type",formatter:e.typeFormatter,"show-overflow-tooltip":!0,width:"160",label:"所属策略"}}),n("el-table-column",{attrs:{prop:"enable",width:"100",label:"是否启用"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-switch",{on:{change:function(n){return e.switchEnableStatus(t.row)}},model:{value:t.row.enable,callback:function(n){e.$set(t.row,"enable",n)},expression:"scope.row.enable"}})]}}])}),n("el-table-column",{attrs:{prop:"enableCache",width:"100",label:"缓存开启"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-switch",{on:{change:function(n){return e.switchCacheEnableStatus(t.row)}},model:{value:t.row.enableCache,callback:function(n){e.$set(t.row,"enableCache",n)},expression:"scope.row.enableCache"}})]}}])}),n("el-table-column",{attrs:{prop:"autoRefreshCache",width:"120",label:"缓存自动刷新"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-switch",{on:{change:function(n){return e.switchAutoRefreshStatus(t.row)}},model:{value:t.row.autoRefreshCache,callback:function(n){e.$set(t.row,"autoRefreshCache",n)},expression:"scope.row.autoRefreshCache"}})]}}])}),n("el-table-column",{attrs:{label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑",placement:"left"}},[n("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(n){return e.editDrive(t.row)}}})],1),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"缓存管理",placement:"top"}},[n("el-button",{staticClass:"el-icon-s-operation",attrs:{size:"mini",disabled:!t.row.enableCache,type:"primary"},on:{click:function(n){return e.cacheManage(t.row)}}})],1),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"文件过滤",placement:"bottom"}},[n("el-button",{staticClass:"el-icon-view",attrs:{size:"mini",type:"primary"},on:{click:function(n){return e.showFilterDialog(t.row)}}})],1),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"right"}},[n("el-button",{staticClass:"el-icon-delete",attrs:{size:"mini",type:"danger"},on:{click:function(n){return e.deleteDrive(t.row)}}})],1)]]}}])})],1),e.driveEditDialogVisible?n("el-dialog",{attrs:{width:"80%",title:"驱动器设置","modal-append-to-body":!1,visible:e.driveEditDialogVisible,top:"10vh","destroy-on-close":!0},on:{"update:visible":function(t){e.driveEditDialogVisible=t}}},[n("drive-edit",{attrs:{"drive-item":e.driveItem,close:e.closeDriveEdit,"support-strategy":e.supportStrategy}})],1):e._e(),e.filterDialogVisible?n("el-dialog",{attrs:{width:"40%",title:"过滤规则","modal-append-to-body":!1,visible:e.filterDialogVisible,top:"10vh","destroy-on-close":!0},on:{"update:visible":function(t){e.filterDialogVisible=t}}},[n("filter-pattern",{attrs:{"drive-id":e.currentCacheManageId,close:e.closeFilterDialog}})],1):e._e(),e.cacheManageVisible?n("el-dialog",{attrs:{id:"cacheDialog",width:"70%",title:"缓存管理","modal-append-to-body":!1,visible:e.cacheManageVisible,top:"10vh","destroy-on-close":!0},on:{"update:visible":function(t){e.cacheManageVisible=t}}},[n("cache-manager",{attrs:{"current-cache-manage-id":this.currentCacheManageId}})],1):e._e()],1)},i=[];
/**!
 * Sortable 1.13.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */
function o(e){return o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(){return s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},s.apply(this,arguments)}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){r(e,t,n[t])}))}return e}function c(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}function d(e,t){if(null==e)return{};var n,a,i=c(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var u="1.13.0";function m(e){if("undefined"!==typeof window&&window.navigator)return!!navigator.userAgent.match(e)}var f=m(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),h=m(/Edge/i),p=m(/firefox/i),g=m(/safari/i)&&!m(/chrome/i)&&!m(/android/i),v=m(/iP(ad|od|hone)/i),b=m(/chrome/i)&&m(/android/i),y={capture:!1,passive:!1};function w(e,t,n){e.addEventListener(t,n,!f&&y)}function _(e,t,n){e.removeEventListener(t,n,!f&&y)}function C(e,t){if(t){if(">"===t[0]&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(n){return!1}return!1}}function k(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function S(e,t,n,a){if(e){n=n||document;do{if(null!=t&&(">"===t[0]?e.parentNode===n&&C(e,t):C(e,t))||a&&e===n)return e;if(e===n)break}while(e=k(e))}return null}var I,x=/\s+/g;function D(e,t,n){if(e&&t)if(e.classList)e.classList[n?"add":"remove"](t);else{var a=(" "+e.className+" ").replace(x," ").replace(" "+t+" "," ");e.className=(a+(n?" "+t:"")).replace(x," ")}}function E(e,t,n){var a=e&&e.style;if(a){if(void 0===n)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),void 0===t?n:n[t];t in a||-1!==t.indexOf("webkit")||(t="-webkit-"+t),a[t]=n+("string"===typeof n?"":"px")}}function T(e,t){var n="";if("string"===typeof e)n=e;else do{var a=E(e,"transform");a&&"none"!==a&&(n=a+" "+n)}while(!t&&(e=e.parentNode));var i=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return i&&new i(n)}function $(e,t,n){if(e){var a=e.getElementsByTagName(t),i=0,o=a.length;if(n)for(;i<o;i++)n(a[i],i);return a}return[]}function P(){var e=document.scrollingElement;return e||document.documentElement}function z(e,t,n,a,i){if(e.getBoundingClientRect||e===window){var o,r,s,l,c,d,u;if(e!==window&&e.parentNode&&e!==P()?(o=e.getBoundingClientRect(),r=o.top,s=o.left,l=o.bottom,c=o.right,d=o.height,u=o.width):(r=0,s=0,l=window.innerHeight,c=window.innerWidth,d=window.innerHeight,u=window.innerWidth),(t||n)&&e!==window&&(i=i||e.parentNode,!f))do{if(i&&i.getBoundingClientRect&&("none"!==E(i,"transform")||n&&"static"!==E(i,"position"))){var m=i.getBoundingClientRect();r-=m.top+parseInt(E(i,"border-top-width")),s-=m.left+parseInt(E(i,"border-left-width")),l=r+o.height,c=s+o.width;break}}while(i=i.parentNode);if(a&&e!==window){var h=T(i||e),p=h&&h.a,g=h&&h.d;h&&(r/=g,s/=p,u/=p,d/=g,l=r+d,c=s+u)}return{top:r,left:s,bottom:l,right:c,width:u,height:d}}}function M(e,t,n){var a=q(e,!0),i=z(e)[t];while(a){var o=z(a)[n],r=void 0;if(r="top"===n||"left"===n?i>=o:i<=o,!r)return a;if(a===P())break;a=q(a,!1)}return!1}function N(e,t,n){var a=0,i=0,o=e.children;while(i<o.length){if("none"!==o[i].style.display&&o[i]!==Ke.ghost&&o[i]!==Ke.dragged&&S(o[i],n.draggable,e,!1)){if(a===t)return o[i];a++}i++}return null}function F(e,t){var n=e.lastElementChild;while(n&&(n===Ke.ghost||"none"===E(n,"display")||t&&!C(n,t)))n=n.previousElementSibling;return n||null}function L(e,t){var n=0;if(!e||!e.parentNode)return-1;while(e=e.previousElementSibling)"TEMPLATE"===e.nodeName.toUpperCase()||e===Ke.clone||t&&!C(e,t)||n++;return n}function O(e){var t=0,n=0,a=P();if(e)do{var i=T(e),o=i.a,r=i.d;t+=e.scrollLeft*o,n+=e.scrollTop*r}while(e!==a&&(e=e.parentNode));return[t,n]}function A(e,t){for(var n in e)if(e.hasOwnProperty(n))for(var a in t)if(t.hasOwnProperty(a)&&t[a]===e[n][a])return Number(n);return-1}function q(e,t){if(!e||!e.getBoundingClientRect)return P();var n=e,a=!1;do{if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var i=E(n);if(n.clientWidth<n.scrollWidth&&("auto"==i.overflowX||"scroll"==i.overflowX)||n.clientHeight<n.scrollHeight&&("auto"==i.overflowY||"scroll"==i.overflowY)){if(!n.getBoundingClientRect||n===document.body)return P();if(a||t)return n;a=!0}}}while(n=n.parentNode);return P()}function R(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function U(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}function j(e,t){return function(){if(!I){var n=arguments,a=this;1===n.length?e.call(a,n[0]):e.apply(a,n),I=setTimeout((function(){I=void 0}),t)}}}function B(){clearTimeout(I),I=void 0}function X(e,t,n){e.scrollLeft+=t,e.scrollTop+=n}function Y(e){var t=window.Polymer,n=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):n?n(e).clone(!0)[0]:e.cloneNode(!0)}var V="Sortable"+(new Date).getTime();function H(){var e,t=[];return{captureAnimationState:function(){if(t=[],this.options.animation){var e=[].slice.call(this.el.children);e.forEach((function(e){if("none"!==E(e,"display")&&e!==Ke.ghost){t.push({target:e,rect:z(e)});var n=l({},t[t.length-1].rect);if(e.thisAnimationDuration){var a=T(e,!0);a&&(n.top-=a.f,n.left-=a.e)}e.fromRect=n}}))}},addAnimationState:function(e){t.push(e)},removeAnimationState:function(e){t.splice(A(t,{target:e}),1)},animateAll:function(n){var a=this;if(!this.options.animation)return clearTimeout(e),void("function"===typeof n&&n());var i=!1,o=0;t.forEach((function(e){var t=0,n=e.target,r=n.fromRect,s=z(n),l=n.prevFromRect,c=n.prevToRect,d=e.rect,u=T(n,!0);u&&(s.top-=u.f,s.left-=u.e),n.toRect=s,n.thisAnimationDuration&&U(l,s)&&!U(r,s)&&(d.top-s.top)/(d.left-s.left)===(r.top-s.top)/(r.left-s.left)&&(t=W(d,l,c,a.options)),U(s,r)||(n.prevFromRect=r,n.prevToRect=s,t||(t=a.options.animation),a.animate(n,d,s,t)),t&&(i=!0,o=Math.max(o,t),clearTimeout(n.animationResetTimer),n.animationResetTimer=setTimeout((function(){n.animationTime=0,n.prevFromRect=null,n.fromRect=null,n.prevToRect=null,n.thisAnimationDuration=null}),t),n.thisAnimationDuration=t)})),clearTimeout(e),i?e=setTimeout((function(){"function"===typeof n&&n()}),o):"function"===typeof n&&n(),t=[]},animate:function(e,t,n,a){if(a){E(e,"transition",""),E(e,"transform","");var i=T(this.el),o=i&&i.a,r=i&&i.d,s=(t.left-n.left)/(o||1),l=(t.top-n.top)/(r||1);e.animatingX=!!s,e.animatingY=!!l,E(e,"transform","translate3d("+s+"px,"+l+"px,0)"),this.forRepaintDummy=K(e),E(e,"transition","transform "+a+"ms"+(this.options.easing?" "+this.options.easing:"")),E(e,"transform","translate3d(0,0,0)"),"number"===typeof e.animated&&clearTimeout(e.animated),e.animated=setTimeout((function(){E(e,"transition",""),E(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1}),a)}}}}function K(e){return e.offsetWidth}function W(e,t,n,a){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))*a.animation}var J=[],Z={initializeByDefault:!0},G={mount:function(e){for(var t in Z)Z.hasOwnProperty(t)&&!(t in e)&&(e[t]=Z[t]);J.forEach((function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")})),J.push(e)},pluginEvent:function(e,t,n){var a=this;this.eventCanceled=!1,n.cancel=function(){a.eventCanceled=!0};var i=e+"Global";J.forEach((function(a){t[a.pluginName]&&(t[a.pluginName][i]&&t[a.pluginName][i](l({sortable:t},n)),t.options[a.pluginName]&&t[a.pluginName][e]&&t[a.pluginName][e](l({sortable:t},n)))}))},initializePlugins:function(e,t,n,a){for(var i in J.forEach((function(a){var i=a.pluginName;if(e.options[i]||a.initializeByDefault){var o=new a(e,t,e.options);o.sortable=e,o.options=e.options,e[i]=o,s(n,o.defaults)}})),e.options)if(e.options.hasOwnProperty(i)){var o=this.modifyOption(e,i,e.options[i]);"undefined"!==typeof o&&(e.options[i]=o)}},getEventProperties:function(e,t){var n={};return J.forEach((function(a){"function"===typeof a.eventProperties&&s(n,a.eventProperties.call(t[a.pluginName],e))})),n},modifyOption:function(e,t,n){var a;return J.forEach((function(i){e[i.pluginName]&&i.optionListeners&&"function"===typeof i.optionListeners[t]&&(a=i.optionListeners[t].call(e[i.pluginName],n))})),a}};function Q(e){var t=e.sortable,n=e.rootEl,a=e.name,i=e.targetEl,o=e.cloneEl,r=e.toEl,s=e.fromEl,c=e.oldIndex,d=e.newIndex,u=e.oldDraggableIndex,m=e.newDraggableIndex,p=e.originalEvent,g=e.putSortable,v=e.extraEventProperties;if(t=t||n&&n[V],t){var b,y=t.options,w="on"+a.charAt(0).toUpperCase()+a.substr(1);!window.CustomEvent||f||h?(b=document.createEvent("Event"),b.initEvent(a,!0,!0)):b=new CustomEvent(a,{bubbles:!0,cancelable:!0}),b.to=r||n,b.from=s||n,b.item=i||n,b.clone=o,b.oldIndex=c,b.newIndex=d,b.oldDraggableIndex=u,b.newDraggableIndex=m,b.originalEvent=p,b.pullMode=g?g.lastPutMode:void 0;var _=l({},v,G.getEventProperties(a,t));for(var C in _)b[C]=_[C];n&&n.dispatchEvent(b),y[w]&&y[w].call(t,b)}}var ee=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=n.evt,i=d(n,["evt"]);G.pluginEvent.bind(Ke)(e,t,l({dragEl:ne,parentEl:ae,ghostEl:ie,rootEl:oe,nextEl:re,lastDownEl:se,cloneEl:le,cloneHidden:ce,dragStarted:Ce,putSortable:pe,activeSortable:Ke.active,originalEvent:a,oldIndex:de,oldDraggableIndex:me,newIndex:ue,newDraggableIndex:fe,hideGhostForTarget:Xe,unhideGhostForTarget:Ye,cloneNowHidden:function(){ce=!0},cloneNowShown:function(){ce=!1},dispatchSortableEvent:function(e){te({sortable:t,name:e,originalEvent:a})}},i))};function te(e){Q(l({putSortable:pe,cloneEl:le,targetEl:ne,rootEl:oe,oldIndex:de,oldDraggableIndex:me,newIndex:ue,newDraggableIndex:fe},e))}var ne,ae,ie,oe,re,se,le,ce,de,ue,me,fe,he,pe,ge,ve,be,ye,we,_e,Ce,ke,Se,Ie,xe,De=!1,Ee=!1,Te=[],$e=!1,Pe=!1,ze=[],Me=!1,Ne=[],Fe="undefined"!==typeof document,Le=v,Oe=h||f?"cssFloat":"float",Ae=Fe&&!b&&!v&&"draggable"in document.createElement("div"),qe=function(){if(Fe){if(f)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}}(),Re=function(e,t){var n=E(e),a=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),i=N(e,0,t),o=N(e,1,t),r=i&&E(i),s=o&&E(o),l=r&&parseInt(r.marginLeft)+parseInt(r.marginRight)+z(i).width,c=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+z(o).width;if("flex"===n.display)return"column"===n.flexDirection||"column-reverse"===n.flexDirection?"vertical":"horizontal";if("grid"===n.display)return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&r["float"]&&"none"!==r["float"]){var d="left"===r["float"]?"left":"right";return!o||"both"!==s.clear&&s.clear!==d?"horizontal":"vertical"}return i&&("block"===r.display||"flex"===r.display||"table"===r.display||"grid"===r.display||l>=a&&"none"===n[Oe]||o&&"none"===n[Oe]&&l+c>a)?"vertical":"horizontal"},Ue=function(e,t,n){var a=n?e.left:e.top,i=n?e.right:e.bottom,o=n?e.width:e.height,r=n?t.left:t.top,s=n?t.right:t.bottom,l=n?t.width:t.height;return a===r||i===s||a+o/2===r+l/2},je=function(e,t){var n;return Te.some((function(a){if(!F(a)){var i=z(a),o=a[V].options.emptyInsertThreshold,r=e>=i.left-o&&e<=i.right+o,s=t>=i.top-o&&t<=i.bottom+o;return o&&r&&s?n=a:void 0}})),n},Be=function(e){function t(e,n){return function(a,i,o,r){var s=a.options.group.name&&i.options.group.name&&a.options.group.name===i.options.group.name;if(null==e&&(n||s))return!0;if(null==e||!1===e)return!1;if(n&&"clone"===e)return e;if("function"===typeof e)return t(e(a,i,o,r),n)(a,i,o,r);var l=(n?a:i).options.group.name;return!0===e||"string"===typeof e&&e===l||e.join&&e.indexOf(l)>-1}}var n={},a=e.group;a&&"object"==o(a)||(a={name:a}),n.name=a.name,n.checkPull=t(a.pull,!0),n.checkPut=t(a.put),n.revertClone=a.revertClone,e.group=n},Xe=function(){!qe&&ie&&E(ie,"display","none")},Ye=function(){!qe&&ie&&E(ie,"display","")};Fe&&document.addEventListener("click",(function(e){if(Ee)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),Ee=!1,!1}),!0);var Ve=function(e){if(ne){e=e.touches?e.touches[0]:e;var t=je(e.clientX,e.clientY);if(t){var n={};for(var a in e)e.hasOwnProperty(a)&&(n[a]=e[a]);n.target=n.rootEl=t,n.preventDefault=void 0,n.stopPropagation=void 0,t[V]._onDragOver(n)}}},He=function(e){ne&&ne.parentNode[V]._isOutsideThisEl(e.target)};function Ke(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=s({},t),e[V]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Re(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==Ke.supportPointer&&"PointerEvent"in window&&!g,emptyInsertThreshold:5};for(var a in G.initializePlugins(this,e,n),n)!(a in t)&&(t[a]=n[a]);for(var i in Be(t),this)"_"===i.charAt(0)&&"function"===typeof this[i]&&(this[i]=this[i].bind(this));this.nativeDraggable=!t.forceFallback&&Ae,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?w(e,"pointerdown",this._onTapStart):(w(e,"mousedown",this._onTapStart),w(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(w(e,"dragover",this),w(e,"dragenter",this)),Te.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),s(this,H())}function We(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function Je(e,t,n,a,i,o,r,s){var l,c,d=e[V],u=d.options.onMove;return!window.CustomEvent||f||h?(l=document.createEvent("Event"),l.initEvent("move",!0,!0)):l=new CustomEvent("move",{bubbles:!0,cancelable:!0}),l.to=t,l.from=e,l.dragged=n,l.draggedRect=a,l.related=i||t,l.relatedRect=o||z(t),l.willInsertAfter=s,l.originalEvent=r,e.dispatchEvent(l),u&&(c=u.call(d,l,r)),c}function Ze(e){e.draggable=!1}function Ge(){Me=!1}function Qe(e,t,n){var a=z(F(n.el,n.options.draggable)),i=10;return t?e.clientX>a.right+i||e.clientX<=a.right&&e.clientY>a.bottom&&e.clientX>=a.left:e.clientX>a.right&&e.clientY>a.top||e.clientX<=a.right&&e.clientY>a.bottom+i}function et(e,t,n,a,i,o,r,s){var l=a?e.clientY:e.clientX,c=a?n.height:n.width,d=a?n.top:n.left,u=a?n.bottom:n.right,m=!1;if(!r)if(s&&Ie<c*i){if(!$e&&(1===Se?l>d+c*o/2:l<u-c*o/2)&&($e=!0),$e)m=!0;else if(1===Se?l<d+Ie:l>u-Ie)return-Se}else if(l>d+c*(1-i)/2&&l<u-c*(1-i)/2)return tt(t);return m=m||r,m&&(l<d+c*o/2||l>u-c*o/2)?l>d+c/2?1:-1:0}function tt(e){return L(ne)<L(e)?1:-1}function nt(e){var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,a=0;while(n--)a+=t.charCodeAt(n);return a.toString(36)}function at(e){Ne.length=0;var t=e.getElementsByTagName("input"),n=t.length;while(n--){var a=t[n];a.checked&&Ne.push(a)}}function it(e){return setTimeout(e,0)}function ot(e){return clearTimeout(e)}Ke.prototype={constructor:Ke,_isOutsideThisEl:function(e){this.el.contains(e)||e===this.el||(ke=null)},_getDirection:function(e,t){return"function"===typeof this.options.direction?this.options.direction.call(this,e,t,ne):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,n=this.el,a=this.options,i=a.preventOnFilter,o=e.type,r=e.touches&&e.touches[0]||e.pointerType&&"touch"===e.pointerType&&e,s=(r||e).target,l=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||s,c=a.filter;if(at(n),!ne&&!(/mousedown|pointerdown/.test(o)&&0!==e.button||a.disabled)&&!l.isContentEditable&&(this.nativeDraggable||!g||!s||"SELECT"!==s.tagName.toUpperCase())&&(s=S(s,a.draggable,n,!1),(!s||!s.animated)&&se!==s)){if(de=L(s),me=L(s,a.draggable),"function"===typeof c){if(c.call(this,e,s,this))return te({sortable:t,rootEl:l,name:"filter",targetEl:s,toEl:n,fromEl:n}),ee("filter",t,{evt:e}),void(i&&e.cancelable&&e.preventDefault())}else if(c&&(c=c.split(",").some((function(a){if(a=S(l,a.trim(),n,!1),a)return te({sortable:t,rootEl:a,name:"filter",targetEl:s,fromEl:n,toEl:n}),ee("filter",t,{evt:e}),!0})),c))return void(i&&e.cancelable&&e.preventDefault());a.handle&&!S(l,a.handle,n,!1)||this._prepareDragStart(e,r,s)}}},_prepareDragStart:function(e,t,n){var a,i=this,o=i.el,r=i.options,s=o.ownerDocument;if(n&&!ne&&n.parentNode===o){var l=z(n);if(oe=o,ne=n,ae=ne.parentNode,re=ne.nextSibling,se=n,he=r.group,Ke.dragged=ne,ge={target:ne,clientX:(t||e).clientX,clientY:(t||e).clientY},we=ge.clientX-l.left,_e=ge.clientY-l.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,ne.style["will-change"]="all",a=function(){ee("delayEnded",i,{evt:e}),Ke.eventCanceled?i._onDrop():(i._disableDelayedDragEvents(),!p&&i.nativeDraggable&&(ne.draggable=!0),i._triggerDragStart(e,t),te({sortable:i,name:"choose",originalEvent:e}),D(ne,r.chosenClass,!0))},r.ignore.split(",").forEach((function(e){$(ne,e.trim(),Ze)})),w(s,"dragover",Ve),w(s,"mousemove",Ve),w(s,"touchmove",Ve),w(s,"mouseup",i._onDrop),w(s,"touchend",i._onDrop),w(s,"touchcancel",i._onDrop),p&&this.nativeDraggable&&(this.options.touchStartThreshold=4,ne.draggable=!0),ee("delayStart",this,{evt:e}),!r.delay||r.delayOnTouchOnly&&!t||this.nativeDraggable&&(h||f))a();else{if(Ke.eventCanceled)return void this._onDrop();w(s,"mouseup",i._disableDelayedDrag),w(s,"touchend",i._disableDelayedDrag),w(s,"touchcancel",i._disableDelayedDrag),w(s,"mousemove",i._delayedDragTouchMoveHandler),w(s,"touchmove",i._delayedDragTouchMoveHandler),r.supportPointer&&w(s,"pointermove",i._delayedDragTouchMoveHandler),i._dragStartTimer=setTimeout(a,r.delay)}}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){ne&&Ze(ne),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;_(e,"mouseup",this._disableDelayedDrag),_(e,"touchend",this._disableDelayedDrag),_(e,"touchcancel",this._disableDelayedDrag),_(e,"mousemove",this._delayedDragTouchMoveHandler),_(e,"touchmove",this._delayedDragTouchMoveHandler),_(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||"touch"==e.pointerType&&e,!this.nativeDraggable||t?this.options.supportPointer?w(document,"pointermove",this._onTouchMove):w(document,t?"touchmove":"mousemove",this._onTouchMove):(w(ne,"dragend",this),w(oe,"dragstart",this._onDragStart));try{document.selection?it((function(){document.selection.empty()})):window.getSelection().removeAllRanges()}catch(n){}},_dragStarted:function(e,t){if(De=!1,oe&&ne){ee("dragStarted",this,{evt:t}),this.nativeDraggable&&w(document,"dragover",He);var n=this.options;!e&&D(ne,n.dragClass,!1),D(ne,n.ghostClass,!0),Ke.active=this,e&&this._appendGhost(),te({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(ve){this._lastX=ve.clientX,this._lastY=ve.clientY,Xe();var e=document.elementFromPoint(ve.clientX,ve.clientY),t=e;while(e&&e.shadowRoot){if(e=e.shadowRoot.elementFromPoint(ve.clientX,ve.clientY),e===t)break;t=e}if(ne.parentNode[V]._isOutsideThisEl(e),t)do{if(t[V]){var n=void 0;if(n=t[V]._onDragOver({clientX:ve.clientX,clientY:ve.clientY,target:e,rootEl:t}),n&&!this.options.dragoverBubble)break}e=t}while(t=t.parentNode);Ye()}},_onTouchMove:function(e){if(ge){var t=this.options,n=t.fallbackTolerance,a=t.fallbackOffset,i=e.touches?e.touches[0]:e,o=ie&&T(ie,!0),r=ie&&o&&o.a,s=ie&&o&&o.d,l=Le&&xe&&O(xe),c=(i.clientX-ge.clientX+a.x)/(r||1)+(l?l[0]-ze[0]:0)/(r||1),d=(i.clientY-ge.clientY+a.y)/(s||1)+(l?l[1]-ze[1]:0)/(s||1);if(!Ke.active&&!De){if(n&&Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))<n)return;this._onDragStart(e,!0)}if(ie){o?(o.e+=c-(be||0),o.f+=d-(ye||0)):o={a:1,b:0,c:0,d:1,e:c,f:d};var u="matrix(".concat(o.a,",").concat(o.b,",").concat(o.c,",").concat(o.d,",").concat(o.e,",").concat(o.f,")");E(ie,"webkitTransform",u),E(ie,"mozTransform",u),E(ie,"msTransform",u),E(ie,"transform",u),be=c,ye=d,ve=i}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!ie){var e=this.options.fallbackOnBody?document.body:oe,t=z(ne,!0,Le,!0,e),n=this.options;if(Le){xe=e;while("static"===E(xe,"position")&&"none"===E(xe,"transform")&&xe!==document)xe=xe.parentNode;xe!==document.body&&xe!==document.documentElement?(xe===document&&(xe=P()),t.top+=xe.scrollTop,t.left+=xe.scrollLeft):xe=P(),ze=O(xe)}ie=ne.cloneNode(!0),D(ie,n.ghostClass,!1),D(ie,n.fallbackClass,!0),D(ie,n.dragClass,!0),E(ie,"transition",""),E(ie,"transform",""),E(ie,"box-sizing","border-box"),E(ie,"margin",0),E(ie,"top",t.top),E(ie,"left",t.left),E(ie,"width",t.width),E(ie,"height",t.height),E(ie,"opacity","0.8"),E(ie,"position",Le?"absolute":"fixed"),E(ie,"zIndex","100000"),E(ie,"pointerEvents","none"),Ke.ghost=ie,e.appendChild(ie),E(ie,"transform-origin",we/parseInt(ie.style.width)*100+"% "+_e/parseInt(ie.style.height)*100+"%")}},_onDragStart:function(e,t){var n=this,a=e.dataTransfer,i=n.options;ee("dragStart",this,{evt:e}),Ke.eventCanceled?this._onDrop():(ee("setupClone",this),Ke.eventCanceled||(le=Y(ne),le.draggable=!1,le.style["will-change"]="",this._hideClone(),D(le,this.options.chosenClass,!1),Ke.clone=le),n.cloneId=it((function(){ee("clone",n),Ke.eventCanceled||(n.options.removeCloneOnHide||oe.insertBefore(le,ne),n._hideClone(),te({sortable:n,name:"clone"}))})),!t&&D(ne,i.dragClass,!0),t?(Ee=!0,n._loopId=setInterval(n._emulateDragOver,50)):(_(document,"mouseup",n._onDrop),_(document,"touchend",n._onDrop),_(document,"touchcancel",n._onDrop),a&&(a.effectAllowed="move",i.setData&&i.setData.call(n,a,ne)),w(document,"drop",n),E(ne,"transform","translateZ(0)")),De=!0,n._dragStartId=it(n._dragStarted.bind(n,t,e)),w(document,"selectstart",n),Ce=!0,g&&E(document.body,"user-select","none"))},_onDragOver:function(e){var t,n,a,i,o=this.el,r=e.target,s=this.options,c=s.group,d=Ke.active,u=he===c,m=s.sort,f=pe||d,h=this,p=!1;if(!Me){if(void 0!==e.preventDefault&&e.cancelable&&e.preventDefault(),r=S(r,s.draggable,o,!0),N("dragOver"),Ke.eventCanceled)return p;if(ne.contains(e.target)||r.animated&&r.animatingX&&r.animatingY||h._ignoreWhileAnimating===r)return A(!1);if(Ee=!1,d&&!s.disabled&&(u?m||(a=!oe.contains(ne)):pe===this||(this.lastPutMode=he.checkPull(this,d,ne,e))&&c.checkPut(this,d,ne,e))){if(i="vertical"===this._getDirection(e,r),t=z(ne),N("dragOverValid"),Ke.eventCanceled)return p;if(a)return ae=oe,O(),this._hideClone(),N("revert"),Ke.eventCanceled||(re?oe.insertBefore(ne,re):oe.appendChild(ne)),A(!0);var g=F(o,s.draggable);if(!g||Qe(e,i,this)&&!g.animated){if(g===ne)return A(!1);if(g&&o===e.target&&(r=g),r&&(n=z(r)),!1!==Je(oe,o,ne,t,r,n,e,!!r))return O(),o.appendChild(ne),ae=o,q(),A(!0)}else if(r.parentNode===o){n=z(r);var v,b,y=0,w=ne.parentNode!==o,_=!Ue(ne.animated&&ne.toRect||t,r.animated&&r.toRect||n,i),C=i?"top":"left",k=M(r,"top","top")||M(ne,"top","top"),I=k?k.scrollTop:void 0;if(ke!==r&&(v=n[C],$e=!1,Pe=!_&&s.invertSwap||w),y=et(e,r,n,i,_?1:s.swapThreshold,null==s.invertedSwapThreshold?s.swapThreshold:s.invertedSwapThreshold,Pe,ke===r),0!==y){var x=L(ne);do{x-=y,b=ae.children[x]}while(b&&("none"===E(b,"display")||b===ie))}if(0===y||b===r)return A(!1);ke=r,Se=y;var T=r.nextElementSibling,$=!1;$=1===y;var P=Je(oe,o,ne,t,r,n,e,$);if(!1!==P)return 1!==P&&-1!==P||($=1===P),Me=!0,setTimeout(Ge,30),O(),$&&!T?o.appendChild(ne):r.parentNode.insertBefore(ne,$?T:r),k&&X(k,0,I-k.scrollTop),ae=ne.parentNode,void 0===v||Pe||(Ie=Math.abs(v-z(r)[C])),q(),A(!0)}if(o.contains(ne))return A(!1)}return!1}function N(s,c){ee(s,h,l({evt:e,isOwner:u,axis:i?"vertical":"horizontal",revert:a,dragRect:t,targetRect:n,canSort:m,fromSortable:f,target:r,completed:A,onMove:function(n,a){return Je(oe,o,ne,t,n,z(n),e,a)},changed:q},c))}function O(){N("dragOverAnimationCapture"),h.captureAnimationState(),h!==f&&f.captureAnimationState()}function A(t){return N("dragOverCompleted",{insertion:t}),t&&(u?d._hideClone():d._showClone(h),h!==f&&(D(ne,pe?pe.options.ghostClass:d.options.ghostClass,!1),D(ne,s.ghostClass,!0)),pe!==h&&h!==Ke.active?pe=h:h===Ke.active&&pe&&(pe=null),f===h&&(h._ignoreWhileAnimating=r),h.animateAll((function(){N("dragOverAnimationComplete"),h._ignoreWhileAnimating=null})),h!==f&&(f.animateAll(),f._ignoreWhileAnimating=null)),(r===ne&&!ne.animated||r===o&&!r.animated)&&(ke=null),s.dragoverBubble||e.rootEl||r===document||(ne.parentNode[V]._isOutsideThisEl(e.target),!t&&Ve(e)),!s.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),p=!0}function q(){ue=L(ne),fe=L(ne,s.draggable),te({sortable:h,name:"change",toEl:o,newIndex:ue,newDraggableIndex:fe,originalEvent:e})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){_(document,"mousemove",this._onTouchMove),_(document,"touchmove",this._onTouchMove),_(document,"pointermove",this._onTouchMove),_(document,"dragover",Ve),_(document,"mousemove",Ve),_(document,"touchmove",Ve)},_offUpEvents:function(){var e=this.el.ownerDocument;_(e,"mouseup",this._onDrop),_(e,"touchend",this._onDrop),_(e,"pointerup",this._onDrop),_(e,"touchcancel",this._onDrop),_(document,"selectstart",this)},_onDrop:function(e){var t=this.el,n=this.options;ue=L(ne),fe=L(ne,n.draggable),ee("drop",this,{evt:e}),ae=ne&&ne.parentNode,ue=L(ne),fe=L(ne,n.draggable),Ke.eventCanceled||(De=!1,Pe=!1,$e=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),ot(this.cloneId),ot(this._dragStartId),this.nativeDraggable&&(_(document,"drop",this),_(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),g&&E(document.body,"user-select",""),E(ne,"transform",""),e&&(Ce&&(e.cancelable&&e.preventDefault(),!n.dropBubble&&e.stopPropagation()),ie&&ie.parentNode&&ie.parentNode.removeChild(ie),(oe===ae||pe&&"clone"!==pe.lastPutMode)&&le&&le.parentNode&&le.parentNode.removeChild(le),ne&&(this.nativeDraggable&&_(ne,"dragend",this),Ze(ne),ne.style["will-change"]="",Ce&&!De&&D(ne,pe?pe.options.ghostClass:this.options.ghostClass,!1),D(ne,this.options.chosenClass,!1),te({sortable:this,name:"unchoose",toEl:ae,newIndex:null,newDraggableIndex:null,originalEvent:e}),oe!==ae?(ue>=0&&(te({rootEl:ae,name:"add",toEl:ae,fromEl:oe,originalEvent:e}),te({sortable:this,name:"remove",toEl:ae,originalEvent:e}),te({rootEl:ae,name:"sort",toEl:ae,fromEl:oe,originalEvent:e}),te({sortable:this,name:"sort",toEl:ae,originalEvent:e})),pe&&pe.save()):ue!==de&&ue>=0&&(te({sortable:this,name:"update",toEl:ae,originalEvent:e}),te({sortable:this,name:"sort",toEl:ae,originalEvent:e})),Ke.active&&(null!=ue&&-1!==ue||(ue=de,fe=me),te({sortable:this,name:"end",toEl:ae,originalEvent:e}),this.save())))),this._nulling()},_nulling:function(){ee("nulling",this),oe=ne=ae=ie=re=le=se=ce=ge=ve=Ce=ue=fe=de=me=ke=Se=pe=he=Ke.dragged=Ke.ghost=Ke.clone=Ke.active=null,Ne.forEach((function(e){e.checked=!0})),Ne.length=be=ye=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":ne&&(this._onDragOver(e),We(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e,t=[],n=this.el.children,a=0,i=n.length,o=this.options;a<i;a++)e=n[a],S(e,o.draggable,this.el,!1)&&t.push(e.getAttribute(o.dataIdAttr)||nt(e));return t},sort:function(e,t){var n={},a=this.el;this.toArray().forEach((function(e,t){var i=a.children[t];S(i,this.options.draggable,a,!1)&&(n[e]=i)}),this),t&&this.captureAnimationState(),e.forEach((function(e){n[e]&&(a.removeChild(n[e]),a.appendChild(n[e]))})),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return S(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var n=this.options;if(void 0===t)return n[e];var a=G.modifyOption(this,e,t);n[e]="undefined"!==typeof a?a:t,"group"===e&&Be(n)},destroy:function(){ee("destroy",this);var e=this.el;e[V]=null,_(e,"mousedown",this._onTapStart),_(e,"touchstart",this._onTapStart),_(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(_(e,"dragover",this),_(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),(function(e){e.removeAttribute("draggable")})),this._onDrop(),this._disableDelayedDragEvents(),Te.splice(Te.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!ce){if(ee("hideClone",this),Ke.eventCanceled)return;E(le,"display","none"),this.options.removeCloneOnHide&&le.parentNode&&le.parentNode.removeChild(le),ce=!0}},_showClone:function(e){if("clone"===e.lastPutMode){if(ce){if(ee("showClone",this),Ke.eventCanceled)return;ne.parentNode!=oe||this.options.group.revertClone?re?oe.insertBefore(le,re):oe.appendChild(le):oe.insertBefore(le,ne),this.options.group.revertClone&&this.animate(ne,le),E(le,"display",""),ce=!1}}else this._hideClone()}},Fe&&w(document,"touchmove",(function(e){(Ke.active||De)&&e.cancelable&&e.preventDefault()})),Ke.utils={on:w,off:_,css:E,find:$,is:function(e,t){return!!S(e,t,e,!1)},extend:R,throttle:j,closest:S,toggleClass:D,clone:Y,index:L,nextTick:it,cancelNextTick:ot,detectDirection:Re,getChild:N},Ke.get=function(e){return e[V]},Ke.mount=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t[0].constructor===Array&&(t=t[0]),t.forEach((function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(Ke.utils=l({},Ke.utils,e.utils)),G.mount(e)}))},Ke.create=function(e,t){return new Ke(e,t)},Ke.version=u;var rt,st,lt,ct,dt,ut,mt=[],ft=!1;function ht(){function e(){for(var e in this.defaults={scroll:!0,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===e.charAt(0)&&"function"===typeof this[e]&&(this[e]=this[e].bind(this))}return e.prototype={dragStarted:function(e){var t=e.originalEvent;this.sortable.nativeDraggable?w(document,"dragover",this._handleAutoScroll):this.options.supportPointer?w(document,"pointermove",this._handleFallbackAutoScroll):t.touches?w(document,"touchmove",this._handleFallbackAutoScroll):w(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var t=e.originalEvent;this.options.dragOverBubble||t.rootEl||this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?_(document,"dragover",this._handleAutoScroll):(_(document,"pointermove",this._handleFallbackAutoScroll),_(document,"touchmove",this._handleFallbackAutoScroll),_(document,"mousemove",this._handleFallbackAutoScroll)),gt(),pt(),B()},nulling:function(){dt=st=rt=ft=ut=lt=ct=null,mt.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,t){var n=this,a=(e.touches?e.touches[0]:e).clientX,i=(e.touches?e.touches[0]:e).clientY,o=document.elementFromPoint(a,i);if(dt=e,t||h||f||g){vt(e,this.options,o,t);var r=q(o,!0);!ft||ut&&a===lt&&i===ct||(ut&&gt(),ut=setInterval((function(){var o=q(document.elementFromPoint(a,i),!0);o!==r&&(r=o,pt()),vt(e,n.options,o,t)}),10),lt=a,ct=i)}else{if(!this.options.bubbleScroll||q(o,!0)===P())return void pt();vt(e,this.options,q(o,!1),!1)}}},s(e,{pluginName:"scroll",initializeByDefault:!0})}function pt(){mt.forEach((function(e){clearInterval(e.pid)})),mt=[]}function gt(){clearInterval(ut)}var vt=j((function(e,t,n,a){if(t.scroll){var i,o=(e.touches?e.touches[0]:e).clientX,r=(e.touches?e.touches[0]:e).clientY,s=t.scrollSensitivity,l=t.scrollSpeed,c=P(),d=!1;st!==n&&(st=n,pt(),rt=t.scroll,i=t.scrollFn,!0===rt&&(rt=q(n,!0)));var u=0,m=rt;do{var f=m,h=z(f),p=h.top,g=h.bottom,v=h.left,b=h.right,y=h.width,w=h.height,_=void 0,C=void 0,k=f.scrollWidth,S=f.scrollHeight,I=E(f),x=f.scrollLeft,D=f.scrollTop;f===c?(_=y<k&&("auto"===I.overflowX||"scroll"===I.overflowX||"visible"===I.overflowX),C=w<S&&("auto"===I.overflowY||"scroll"===I.overflowY||"visible"===I.overflowY)):(_=y<k&&("auto"===I.overflowX||"scroll"===I.overflowX),C=w<S&&("auto"===I.overflowY||"scroll"===I.overflowY));var T=_&&(Math.abs(b-o)<=s&&x+y<k)-(Math.abs(v-o)<=s&&!!x),$=C&&(Math.abs(g-r)<=s&&D+w<S)-(Math.abs(p-r)<=s&&!!D);if(!mt[u])for(var M=0;M<=u;M++)mt[M]||(mt[M]={});mt[u].vx==T&&mt[u].vy==$&&mt[u].el===f||(mt[u].el=f,mt[u].vx=T,mt[u].vy=$,clearInterval(mt[u].pid),0==T&&0==$||(d=!0,mt[u].pid=setInterval(function(){a&&0===this.layer&&Ke.active._onTouchMove(dt);var t=mt[this.layer].vy?mt[this.layer].vy*l:0,n=mt[this.layer].vx?mt[this.layer].vx*l:0;"function"===typeof i&&"continue"!==i.call(Ke.dragged.parentNode[V],n,t,e,dt,mt[this.layer].el)||X(mt[this.layer].el,n,t)}.bind({layer:u}),24))),u++}while(t.bubbleScroll&&m!==c&&(m=q(m,!1)));ft=d}}),30),bt=function(e){var t=e.originalEvent,n=e.putSortable,a=e.dragEl,i=e.activeSortable,o=e.dispatchSortableEvent,r=e.hideGhostForTarget,s=e.unhideGhostForTarget;if(t){var l=n||i;r();var c=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,d=document.elementFromPoint(c.clientX,c.clientY);s(),l&&!l.el.contains(d)&&(o("spill"),this.onSpill({dragEl:a,putSortable:n}))}};function yt(){}function wt(){}yt.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,n=e.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var a=N(this.sortable.el,this.startIndex,this.options);a?this.sortable.el.insertBefore(t,a):this.sortable.el.appendChild(t),this.sortable.animateAll(),n&&n.animateAll()},drop:bt},s(yt,{pluginName:"revertOnSpill"}),wt.prototype={onSpill:function(e){var t=e.dragEl,n=e.putSortable,a=n||this.sortable;a.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),a.animateAll()},drop:bt},s(wt,{pluginName:"removeOnSpill"});Ke.mount(new ht),Ke.mount(wt,yt);var _t=Ke,Ct=n("fed1"),kt=n.n(Ct),St=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.supportStrategy?n("div",[n("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{"element-loading-text":"保存并初始化中.",id:"siteForm",model:e.driveItem,rules:e.rules,"label-width":"auto","status-icon":!0}},[n("el-row",{staticClass:"box animate__animated animate__fadeIn",attrs:{gutter:50}},[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"驱动器名称",prop:"name"}},[n("el-input",{model:{value:e.driveItem.name,callback:function(t){e.$set(e.driveItem,"name",t)},expression:"driveItem.name"}})],1),n("el-form-item",{attrs:{label:"是否启用"}},[n("el-switch",{model:{value:e.driveItem.enable,callback:function(t){e.$set(e.driveItem,"enable",t)},expression:"driveItem.enable"}}),n("el-tooltip",{attrs:{placement:"right"}},[n("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n                            如不启用，则不在首页展示。\n                        ")]),n("i",{staticClass:"el-icon-info zfile-info-tooltip"})])],1),n("el-form-item",{attrs:{label:"是否默认打开图片模式"}},[n("el-switch",{model:{value:e.driveItem.defaultSwitchToImgMode,callback:function(t){e.$set(e.driveItem,"defaultSwitchToImgMode",t)},expression:"driveItem.defaultSwitchToImgMode"}}),n("el-tooltip",{attrs:{placement:"right"}},[n("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n                            启用后，每次切换到此存储器，是否默认打开图片模式\n                        ")]),n("i",{staticClass:"el-icon-info zfile-info-tooltip"})])],1),n("el-form-item",{attrs:{label:"开启缓存"}},[n("el-switch",{on:{change:e.cacheChange},model:{value:e.driveItem.enableCache,callback:function(t){e.$set(e.driveItem,"enableCache",t)},expression:"driveItem.enableCache"}}),n("el-tooltip",{attrs:{placement:"right"}},[n("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n                            开启缓存后，N 秒内重复请求相同文件夹，不会重复调用 API。\n                            "),n("br"),e._v("\n                            参数 N 在配置文件中设置 {zfile.cache.timeout}，默认为 1800 秒。\n                            "),n("br"),n("br"),e._v("\n                            注意：开启缓存后，可能会导致系统不稳定，如非必要或不了解缓存的，不建议开启此功能。\n                        ")]),n("i",{staticClass:"el-icon-info zfile-info-tooltip"})])],1),n("el-form-item",{attrs:{label:"开启缓存自动刷新"}},[n("el-switch",{model:{value:e.driveItem.autoRefreshCache,callback:function(t){e.$set(e.driveItem,"autoRefreshCache",t)},expression:"driveItem.autoRefreshCache"}}),n("el-tooltip",{attrs:{placement:"right"}},[n("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n                            每隔 N 秒检测到期的缓存, 对于过期缓存尝试调用 API, 重新写入缓存.\n                            "),n("br"),e._v("\n                            参数 N 在配置文件中设置 {zfile.cache.auto-refresh-interval}，默认为 5 秒。\n                            "),n("br"),n("br"),e._v("\n                            注意：如您的数据，并非\n                        ")]),n("i",{staticClass:"el-icon-info zfile-info-tooltip"})])],1),n("el-form-item",{attrs:{label:"存储策略",prop:"type"}},[n("el-select",{attrs:{filterable:"",placeholder:"请选择存储策略"},model:{value:e.driveItem.type,callback:function(t){e.$set(e.driveItem,"type",t)},expression:"driveItem.type"}},e._l(e.supportStrategy,(function(e){return n("el-option",{key:e.key,attrs:{label:e.description,value:e.key}})})),1)],1)],1),n("el-col",{attrs:{span:12}},[e._l(e.storageStrategyForm,(function(t){return"siteType"!==t.key?n("el-form-item",{key:t.title,attrs:{label:t.title,prop:"storageStrategyConfig."+t.key}},[n("el-col",{staticClass:"el-drive-form-col",attrs:{span:22}},["endPoint"===t.key&&e.region.hasOwnProperty(e.driveItem.type)?n("el-select",{model:{value:e.driveItem.storageStrategyConfig.endPoint,callback:function(t){e.$set(e.driveItem.storageStrategyConfig,"endPoint",t)},expression:"driveItem.storageStrategyConfig.endPoint"}},e._l(e.region[e.driveItem.type],(function(e){return n("el-option",{key:e.name,attrs:{label:e.name,value:e.val}})})),1):"pathStyle"===t.key?n("div",[n("el-select",{model:{value:e.driveItem.storageStrategyConfig.pathStyle,callback:function(t){e.$set(e.driveItem.storageStrategyConfig,"pathStyle",t)},expression:"driveItem.storageStrategyConfig.pathStyle"}},[n("el-option",{attrs:{label:"bucket-virtual-hosting",value:"bucket-virtual-hosting"}}),n("el-option",{attrs:{label:"path-style",value:"path-style"}})],1),n("el-link",{staticClass:"zfile-word-aux",attrs:{target:"_blank",icon:"el-icon-document",href:"https://docs.aws.amazon.com/zh_cn/AmazonS3/latest/dev/VirtualHosting.html#path-style-access"}},[e._v("查看 S3 API 说明文档")])],1):"isPrivate"===t.key?n("div",[n("el-switch",{model:{value:e.driveItem.storageStrategyConfig.isPrivate,callback:function(t){e.$set(e.driveItem.storageStrategyConfig,"isPrivate",t)},expression:"driveItem.storageStrategyConfig.isPrivate"}}),n("el-tooltip",{attrs:{placement:"right"}},[n("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n                                    私有空间会生成带签名的下载链接\n                                ")]),n("i",{staticClass:"el-icon-question zfile-info-tooltip"})])],1):"siteName"!==t.key||"sharepoint"!==e.driveItem.type&&"sharepoint-china"!==e.driveItem.type?n("el-input",{attrs:{placeholder:""},on:{input:function(t){return e.change(t)}},model:{value:e.driveItem.storageStrategyConfig[t.key],callback:function(n){e.$set(e.driveItem.storageStrategyConfig,t.key,n)},expression:"driveItem.storageStrategyConfig[item.key]"}}):n("div",[n("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入站点名称"},model:{value:e.driveItem.storageStrategyConfig.siteName,callback:function(t){e.$set(e.driveItem.storageStrategyConfig,"siteName",t)},expression:"driveItem.storageStrategyConfig.siteName"}},[n("el-select",{staticClass:"zfile-site-id-input-site-type-select",attrs:{slot:"prepend"},on:{input:function(t){return e.change(t)}},slot:"prepend",model:{value:e.driveItem.storageStrategyConfig.siteType,callback:function(t){e.$set(e.driveItem.storageStrategyConfig,"siteType",t)},expression:"driveItem.storageStrategyConfig.siteType"}},[n("el-option",{attrs:{label:"/sites/",value:"/sites/"}}),n("el-option",{attrs:{label:"/teams/",value:"/teams/"}})],1)],1)],1)],1),"basePath"===t.key?n("div",[n("el-tooltip",{attrs:{placement:"bottom"}},[n("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n                                基路径表示从哪个路径开始文件, 不填写表示从根开始\n                            ")]),n("i",{staticClass:"el-icon-question zfile-info-tooltip"})])],1):e._e(),"filePath"===t.key?n("div",[n("el-tooltip",{attrs:{placement:"bottom"}},[n("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n                                Linux 或对象存储等需以 / 开头.\n                                "),n("br"),e._v("\n                                Windows 支持 C:/ 类的盘符开头.\n                                "),n("br"),e._v("\n                                结尾不需要加 "),n("b",[e._v("/")]),e._v(".\n                            ")]),n("i",{staticClass:"el-icon-question zfile-info-tooltip"})])],1):e._e(),"domain"===t.key&&"ftp"===e.driveItem.type?n("div",[n("el-tooltip",{attrs:{placement:"bottom"}},[n("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n                                此域名表示 http 访问域名，如有端口，也需要写明。\n                            ")]),n("i",{staticClass:"el-icon-question zfile-info-tooltip"})])],1):e._e(),"siteName"!==t.key||"sharepoint"!==e.driveItem.type&&"sharepoint-china"!==e.driveItem.type?e._e():n("div",[n("el-tooltip",{attrs:{placement:"bottom"}},[n("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n                                /sites/xxx 或 /teams/xxx ，xxx 为你的站点名称\n                            ")]),n("i",{staticClass:"el-icon-question zfile-info-tooltip"})])],1),"siteId"!==t.key||"sharepoint"!==e.driveItem.type&&"sharepoint-china"!==e.driveItem.type?e._e():n("div",[n("el-tooltip",{attrs:{placement:"bottom"}},[n("div",{attrs:{slot:"content"},slot:"content"},[e._v('\n                                输入 "访问令牌" 和 "站点名称" 后，可以自动获取 SiteId。\n                                '),n("br"),e._v('\n                                如无法自动获取，请点击下方的 "前往获取 Site Id"。\n                            ')]),n("i",{staticClass:"el-icon-question zfile-info-tooltip"})])],1)],1):e._e()})),"onedrive"===e.driveItem.type||"sharepoint"===e.driveItem.type?n("el-form-item",[n("el-link",{attrs:{target:"_blank",icon:"el-icon-link",href:e.$http.defaults.baseURL+"/onedrive/authorize"}},[e._v("前往获取令牌")]),n("br"),n("el-link",{directives:[{name:"show",rawName:"v-show",value:"sharepoint"===e.driveItem.type,expression:"driveItem.type === 'sharepoint'"}],attrs:{target:"_blank",icon:"el-icon-link",href:"/#/sharepoint-util"}},[e._v("前往获取 Site Id")])],1):e._e(),"onedrive-china"===e.driveItem.type||"sharepoint-china"===e.driveItem.type?n("el-form-item",[n("el-link",{attrs:{target:"_blank",icon:"el-icon-link",href:e.$http.defaults.baseURL+"/onedrive/china-authorize"}},[e._v("前往获取令牌")]),n("br"),n("el-link",{directives:[{name:"show",rawName:"v-show",value:"sharepoint-china"===e.driveItem.type,expression:"driveItem.type === 'sharepoint-china'"}],attrs:{target:"_blank",icon:"el-icon-link",href:"/#/sharepoint-util"}},[e._v("前往获取 Site Id")])],1):e._e(),"ftp"===e.driveItem.type?n("el-form-item",[n("div",{staticClass:"zfile-word-aux zfile-margin-left-unset"},[e._v("\n                        注意: FTP 协议，如果不填写加速域名 (HTTP 下载地址)，则会使用 FTP 协议进行下载\n                        "),n("br"),e._v("\n                        FTP 协议会在 URL 中暴露用户名密码，如："),n("b",[e._v("ftp://用户名:密码@IP:端口/文件路径/文件名")]),n("br"),e._v("\n                        如为 FTP 提供了加速域名 (HTTP 下载地址)，则会使用 HTTP 协议，如："),n("b",[e._v("http(s)://加速域名/文件路径/文件名")])])]):e._e()],2)],1)],1),n("div",{staticClass:"zfile-text-align-center",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary",disabled:e.loading},on:{click:function(t){return e.submitForm("form")}}},[e._v("保 存")]),n("el-button",{on:{click:e.close}},[e._v("取 消")])],1)],1):e._e()},It=[],xt={aliyun:[{name:"华东 1（杭州）",val:"oss-cn-hangzhou.aliyuncs.com"},{name:"华东 2（上海）",val:"oss-cn-shanghai.aliyuncs.com"},{name:"华北 1（青岛）",val:"oss-cn-qingdao.aliyuncs.com"},{name:"华北 2（北京）",val:"oss-cn-beijing.aliyuncs.com"},{name:"华北 3（张家口）",val:"oss-cn-zhangjiakou.aliyuncs.com"},{name:"华北 5（呼和浩特）",val:"oss-cn-huhehaote.aliyuncs.com"},{name:"华南 1（深圳）",val:"oss-cn-shenzhen.aliyuncs.com"},{name:"西南 1（成都）",val:"oss-cn-chengdu.aliyuncs.com"},{name:"中国（香港）",val:"oss-cn-hongkong.aliyuncs.com"},{name:"美国西部 1 （硅谷）",val:"oss-us-west-1.aliyuncs.com"},{name:"美国东部 1 （弗吉尼亚）",val:"oss-us-east-1.aliyuncs.com"},{name:"亚太东南 1 （新加坡）",val:"oss-ap-southeast-1.aliyuncs.com"},{name:"亚太东南 2 （悉尼）",val:"oss-ap-southeast-2.aliyuncs.com"},{name:"亚太东南 3 （吉隆坡）",val:"oss-ap-southeast-3.aliyuncs.com"},{name:"亚太东南 5 （雅加达）",val:"oss-ap-southeast-5.aliyuncs.com"},{name:"亚太东北 1 （日本）",val:"oss-ap-northeast-1.aliyuncs.com"},{name:"亚太南部 1 （孟买）",val:"oss-ap-south-1.aliyuncs.com"},{name:"欧洲中部 1 （法兰克福）",val:"oss-eu-central-1.aliyuncs.com"},{name:"英国（伦敦）",val:"oss-eu-west-1.aliyuncs.com"},{name:"中东东部 1 （迪拜）",val:"oss-me-east-1.aliyuncs.com"}],tencent:[{name:"北京",val:"cos.ap-beijing.myqcloud.com"},{name:"上海",val:"cos.ap-shanghai.myqcloud.com"},{name:"广州",val:"cos.ap-guangzhou.myqcloud.com"},{name:"成都",val:"cos.ap-chengdu.myqcloud.com"},{name:"重庆",val:"cos.ap-chongqing.myqcloud.com"},{name:"深圳金融",val:"cos.ap-shenzhen-fsi.myqcloud.com"},{name:"上海金融",val:"cos.ap-shanghai-fsi.myqcloud.com"},{name:"北京金融",val:"cos.ap-beijing-fsi.myqcloud.com"},{name:"中国香港",val:"cos.ap-hongkong.myqcloud.com"},{name:"新加坡",val:"cos.ap-singapore.myqcloud.com"},{name:"孟买",val:"cos.ap-mumbai.myqcloud.com"},{name:"首尔",val:"cos.ap-seoul.myqcloud.com"},{name:"曼谷",val:"cos.ap-bangkok.myqcloud.com"},{name:"东京",val:"cos.ap-tokyo.myqcloud.com"},{name:"硅谷",val:"cos.na-siliconvalley.myqcloud.com"},{name:"弗吉尼亚",val:"cos.na-ashburn.myqcloud.com"},{name:"多伦多",val:"cos.na-toronto.myqcloud.com"},{name:"法兰克福",val:"cos.eu-frankfurt.myqcloud.com"},{name:"莫斯科",val:"cos.eu-moscow"}],huawei:[{name:"非洲-约翰内斯堡",val:"obs.af-south-1.myhuaweicloud.com"},{name:"华北-北京四",val:"obs.cn-north-4.myhuaweicloud.com"},{name:"华北-北京一",val:"obs.cn-north-1.myhuaweicloud.com"},{name:"华东-上海二",val:"obs.cn-east-2.myhuaweicloud.com"},{name:"华东-上海一",val:"obs.cn-east-3.myhuaweicloud.com"},{name:"华南-广州",val:"obs.cn-south-1.myhuaweicloud.com"},{name:"西南-贵阳一",val:"obs.cn-southwest-2.myhuaweicloud.com"},{name:"亚太-曼谷",val:"obs.ap-southeast-2.myhuaweicloud.com"},{name:"亚太-香港",val:"obs.ap-southeast-1.myhuaweicloud.com"},{name:"亚太-新加坡",val:"obs.ap-southeast-3.myhuaweicloud.com"}],qiniu:[{name:"华东",val:"s3-cn-east-1.qiniucs.com"},{name:"华北",val:"s3-cn-north-1.qiniucs.com"},{name:"华南",val:"s3-cn-south-1.qiniucs.com"},{name:"北美",val:"s3-us-north-1.qiniucs.com"},{name:"东南亚",val:"s3-ap-southeast-1.qiniucs.com"}]},Dt=xt,Et={name:"DriveEdit",props:{close:{type:Function},driveItem:{orderNum:null,name:"",type:null,searchEnable:!1,searchIgnoreCase:!1,searchContainEncryptedFile:!1,enableCache:!1,autoRefreshCache:!1,storageStrategyConfig:{endPoint:"",pathStyle:"",isPrivate:!1,accessKey:null,secretKey:null,bucketName:null,host:null,port:null,filePath:null,accessToken:null,refreshToken:null,secretId:null,username:null,password:null,basePath:"",domain:"",siteType:"/sites/",siteId:""}},supportStrategy:null},watch:{"driveItem.type":function(e){e?this.loadStrategyForm(e):this.storageStrategyForm=null},"driveItem.storageStrategyConfig.siteName":function(){var e=this;if(this.driveItem.storageStrategyConfig.siteName&&this.driveItem.storageStrategyConfig.accessToken){var t={type:"sharepoint"===this.driveItem.type?"Standard":"China",accessToken:this.driveItem.storageStrategyConfig.accessToken,siteType:this.driveItem.storageStrategyConfig.siteType,siteName:this.driveItem.storageStrategyConfig.siteName};this.$http.post("/sharepoint/getSiteId",t).then((function(t){t.data.code===e.common.responseCode.SUCCESS&&(e.driveItem.storageStrategyConfig.siteId=t.data.data,e.$forceUpdate(),e.$message.success("自动获取 SiteId 成功"))}))}}},data:function(){var e=this;return{region:Dt,loading:!1,storageStrategyForm:[],rules:{siteName:[{required:!0,message:"请输入站点名称",trigger:"change"}],username:[{required:!0,message:"请输入管理员账号",trigger:"change"}],password:[{required:!0,message:"请输入管理员密码",trigger:"change"}],domain:[{required:!0,type:"url",message:"请输入正确的域名，需以 http:// 或 https:// 开头",trigger:"change"}],type:[{required:!0,message:"存储策略不能为空",trigger:"change"}],"storageStrategyConfig.domain":[{validator:function(t,n,a){var i=/(http|https):\/\/([\w.]+\/?)\S*/;void 0!==n&&""!==n||"ftp"!==e.driveItem.type?void 0!==n&&""!==n?i.test(n)?n.lastIndexOf("/")===n.length-1?a(new Error("请输入正确的域名，不能以 / 结尾")):a():a(new Error("请输入正确的域名，需以 http:// 或 https:// 开头")):a(new Error("域名不能为空")):a()},type:"url",trigger:"change"}],"storageStrategyConfig.username":[{validator:function(t,n,a){"upyun"!==e.driveItem.type&&"ufile"!==e.driveItem.type||void 0!==n&&""!==n?a():a(new Error("操作员名称不能为空"))}}],"storageStrategyConfig.password":[{validator:function(t,n,a){"upyun"!==e.driveItem.type&&"ufile"!==e.driveItem.type||void 0!==n&&""!==n?a():a(new Error("操作员密码不能为空"))}}],"storageStrategyConfig.endPoint":[{required:!0,message:"区域不能为空"}],"storageStrategyConfig.accessKey":[{required:!0,message:"AccessKey 不能为空"}],"storageStrategyConfig.filePath":[{required:!0,message:"文件路径不能为空"}],"storageStrategyConfig.secretKey":[{required:!0,message:"SecretKey 不能为空"}],"storageStrategyConfig.bucketName":[{required:!0,message:"此项不能为空"}],"storageStrategyConfig.host":[{required:!0,message:"域名或 IP 不能为空"}],"storageStrategyConfig.port":[{required:!0,message:"端口不能为空"}],"storageStrategyConfig.accessToken":[{required:!0,message:"访问令牌不能为空"}],"storageStrategyConfig.refreshToken":[{required:!0,message:"刷新令牌不能为空"}],"storageStrategyConfig.secretId":[{required:!0,message:"SecretId 不能为空"}],"storageStrategyConfig.siteId":[{required:!0,message:"SiteId 不能为空"}]}}},methods:{cacheChange:function(e){e||(this.driveItem.autoRefreshCache=!1)},loadStrategyForm:function(e){var t=this;this.$http.get("admin/strategy-form",{params:{storageType:e}}).then((function(n){t.storageStrategyForm=n.data.data,"sharepoint"!==e&&"sharepoint-china"!==e||(t.driveItem.storageStrategyConfig.siteType="/sites/")}))},change:function(){this.$forceUpdate()},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.loading=!0,t.$http.post("admin/drive",t.driveItem).then((function(e){var n=e.data;t.$message({message:n.msg,type:0===n.code?"success":"error",duration:1500}),t.close(),t.loading=!1})).catch((function(){t.loading=!1}))}))}},mounted:function(){this.driveItem.type&&this.loadStrategyForm(this.driveItem.type)}},Tt=Et,$t=(n("8d57"),n("5d22")),Pt=Object($t["a"])(Tt,St,It,!1,null,"6669110c",null),zt=Pt.exports,Mt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-row",{staticClass:"zfile-cache-statistics",attrs:{gutter:20}},[n("el-col",{attrs:{span:8}},[n("el-card",{attrs:{shadow:"always"}},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",{staticClass:"card-title"},[e._v("缓存数")]),n("el-button",{staticClass:"zfile-float-right",attrs:{size:"mini",icon:"el-icon-delete",round:"",type:"danger"},on:{click:e.clearCache}},[e._v("清理缓存")])],1),n("div",{staticClass:"card-content",domProps:{textContent:e._s(e.driveCacheInfo.cacheCount)}})])],1),n("el-col",{attrs:{span:8}},[n("el-card",{attrs:{shadow:"always"}},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",{staticClass:"card-title"},[e._v("命中数")])]),n("div",{staticClass:"card-content",domProps:{textContent:e._s(e.driveCacheInfo.hitCount)}})])],1),n("el-col",{attrs:{span:8}},[n("el-card",{attrs:{shadow:"always"}},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",{staticClass:"card-title"},[e._v("未命中数")])]),n("div",{staticClass:"card-content",domProps:{textContent:e._s(e.driveCacheInfo.missCount)}})])],1)],1),n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:20}},[n("el-input",{attrs:{placeholder:"输入关键字搜索"},model:{value:e.cacheSearch,callback:function(t){e.cacheSearch=t},expression:"cacheSearch"}})],1),n("el-col",{attrs:{span:4}},[n("el-button",{staticClass:"zfile-float-right",attrs:{size:"small",type:"primary",icon:"el-icon-refresh"},on:{click:e.refreshCacheManageData}},[e._v("刷新统计信息")])],1)],1),n("el-table",{staticClass:"zfile-cache-table",attrs:{height:"50vh",data:e.driveCacheInfo.cacheKeys.filter((function(t){return!e.cacheSearch||t.name.toLowerCase().includes(e.cacheSearch.toLowerCase())}))}},[n("el-table-column",{attrs:{prop:"name",label:"缓存 Key (文件夹名称)","min-width":"75%"}}),n("el-table-column",{attrs:{"min-width":"25%",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini",type:"primary",round:""},on:{click:function(n){return e.refreshCache(t.row)}}},[e._v("刷新缓存")])]}}])})],1)],1)},Nt=[],Ft=(n("3441"),n("a450"),{name:"CacheManager",props:{currentCacheManageId:null},data:function(){return{cacheSearch:"",driveCacheInfo:{cacheCount:0,hitCount:0,missCount:0,cacheKeys:[]}}},methods:{refreshCache:function(e){var t=this;this.$http.post("admin/cache/".concat(this.currentCacheManageId,"/refresh"),kt.a.stringify({key:e.name})).then((function(){t.$message({message:"刷新成功",type:"success"})}))},refreshCacheManageData:function(){this.loadCacheManageData(),this.$message({message:"刷新成功",type:"success"})},loadCacheManageData:function(){var e=this;this.$http.get("admin/cache/".concat(this.currentCacheManageId,"/info")).then((function(t){var n=t.data.data,a=n.cacheKeys;a.sort((function(e,t){return e.length-t.length}));for(var i=[],o=0;o<a.length;o++)i[o]={name:a[o]};n.cacheKeys=i,e.driveCacheInfo=n}))},clearCache:function(){var e=this;this.$http.post("admin/cache/".concat(this.currentCacheManageId,"/clear")).then((function(){e.loadCacheManageData(),e.$message({message:"清理成功",type:"success"})}))}},beforeMount:function(){this.loadCacheManageData()}}),Lt=Ft,Ot=(n("3823"),Object($t["a"])(Lt,Mt,Nt,!1,null,"f4e53df0",null)),At=Ot.exports,qt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-form",{ref:"filterForm",attrs:{id:"filterForm",model:e.filterForm,"label-width":"120px"}},[e._l(e.filterForm.filterList,(function(t,a){return n("div",{key:a},[n("el-row",[n("el-col",{attrs:{span:20}},[n("el-form-item",{attrs:{prop:"filterList."+a+".expression",rules:{required:!0,message:"此项不能为空",trigger:"blur"},label:"表达式 "+(a+1)}},[n("el-input",{attrs:{size:"small"},model:{value:t.expression,callback:function(n){e.$set(t,"expression",n)},expression:"item.expression"}})],1)],1),n("el-col",{attrs:{span:4}},[n("el-button",{staticClass:"zfile-filter-delete-btn",attrs:{type:"danger",size:"small",icon:"el-icon-delete"},on:{click:function(t){return e.deleteFilterItem(a)}}},[e._v("删除\n                    ")])],1)],1)],1)})),n("el-form-item",[n("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:e.addFilterItem}},[e._v("添加更多")])],1),n("el-form-item",[n("span",{staticClass:"zfile-word-aux zfile-margin-left-unset"},[e._v("\n                    表达式规则:\n                    "),n("br"),e._v("\n                    *: 单级路径通配符，如表达式 /*.jpg，可以匹配根路径下所有的 jpg 后缀的文件\n                    "),n("br"),e._v("\n                    **: 多级路径通配符，如表达式 **.jpg，可以匹配所有路径下的 jpg 后缀的文件\n                    "),n("br"),e._v("\n                    注意："),n("b",[e._v("/a.png")]),e._v(" 表示根路径下的 a.png。 "),n("b",[e._v("/a/b/c.png")]),e._v("，表示 /a/b/ 路径下的 c.png。 "),n("b",[e._v("a.png")]),e._v("，什么都不表示，因为未标注路径。\n                ")])])],2),n("div",{staticClass:"zfile-filter-save-btn",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-check"},on:{click:e.saveFilterForm}},[e._v("保存")])],1)],1)},Rt=[],Ut={name:"FilterPattern",props:{close:{type:Function},driveId:null},data:function(){return{filterForm:{filterList:[]}}},methods:{loadFilterData:function(){var e=this;this.$http.get("admin/drive/".concat(this.driveId,"/filters")).then((function(t){e.filterForm.filterList=t.data.data}))},addFilterItem:function(){this.filterForm.filterList.push({expression:"",driveId:this.driveId})},deleteFilterItem:function(e){this.filterForm.filterList.splice(e,1)},saveFilterForm:function(){var e=this;this.$http.post("admin/drive/".concat(this.driveId,"/filters"),this.filterForm.filterList).then((function(){e.$message({message:"保存成功",type:"success"}),e.close()}))}},mounted:function(){this.loadFilterData()}},jt=Ut,Bt=(n("066d"),Object($t["a"])(jt,qt,Rt,!1,null,"e3077b30",null)),Xt=Bt.exports,Yt={name:"DriveList",components:{FilterPattern:Xt,CacheManager:At,DriveEdit:zt},data:function(){return{loading:!1,driveList:[],supportStrategy:[],driveItem:{orderNum:null,name:"",type:null,enable:!0,defaultSwitchToImgMode:!1,searchEnable:!1,searchIgnoreCase:!1,searchContainEncryptedFile:!1,enableCache:!1,autoRefreshCache:!1,storageStrategyConfig:{endPoint:"",pathStyle:"",isPrivate:!1,accessKey:null,secretKey:null,bucketName:null,host:null,port:null,filePath:null,accessToken:null,refreshToken:null,secretId:null,username:null,password:null,basePath:"",domain:""}},sortable:null,driveEditDialogVisible:!1,filterDialogVisible:!1,cacheManageVisible:!1,currentCacheManageId:null}},methods:{editDriveId:function(e){var t=this;this.$prompt("请输入要修改为的 ID，需为大于零的整数。","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^[1-9]\d{0,9}$/,inputErrorMessage:"ID 只能为大于零的整数，最大支持 9 位数字。"}).then((function(n){var a=n.value;t.$http.post("admin/drive/updateId",kt.a.stringify({updateId:e,newId:a})).then((function(){t.$message({message:"修改成功",type:"success"}),t.init()}))}))},setSort:function(){var e=this,t=document.querySelector(".el-table__body-wrapper tbody");_t.create(t,{onEnd:function(t){if(t.oldIndex!==t.newIndex){var n=e.driveList.splice(t.oldIndex,1)[0];e.driveList.splice(t.newIndex,0,n),e.$http.post("admin/drive/drag",e.driveList).then((function(){e.$message({message:"调整排序成功",type:"success"})}))}}})},clearCache:function(){var e=this;this.$http.post("admin/cache/".concat(this.currentCacheManageId,"/clear")).then((function(){e.loadCacheManageData(),e.$message({message:"清理成功",type:"success"})}))},cacheManage:function(e){this.currentCacheManageId=e.id,this.cacheManageVisible=!0},showFilterDialog:function(e){this.currentCacheManageId=e.id,this.filterDialogVisible=!0},switchEnableStatus:function(e){var t=this,n=e.enable?"enable":"disable";this.$http.post("admin/drive/"+e.id+"/"+n).then((function(){t.$message.success("修改成功")}))},switchCacheEnableStatus:function(e){var t=this,n=e.enableCache?"enable":"disable";this.$http.post("admin/cache/"+e.id+"/"+n).then((function(){t.$message.success("修改成功")}))},switchAutoRefreshStatus:function(e){var t=this,n=e.autoRefreshCache?"start":"stop";this.$http.post("admin/cache/"+e.id+"/auto-refresh/"+n).then((function(){t.$message.success("修改成功")}))},typeFormatter:function(e,t,n){for(var a in this.supportStrategy)if(this.supportStrategy[a].key===n)return this.supportStrategy[a].description},editDrive:function(e){var t=this;this.$http.get("admin/drive/"+e.id).then((function(e){var n=e.data.data;n.type=n.type.key,t.driveItem=n,t.driveEditDialogVisible=!0}))},deleteDrive:function(e){var t=this;this.$confirm("是否确认删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",callback:function(n){"confirm"===n&&t.$http.delete("admin/drive/"+e.id).then((function(e){e.data.code===t.common.responseCode.SUCCESS?(t.$message.success("删除成功"),t.init()):t.$message.success("删除失败")}))}})},closeDriveEdit:function(){this.driveEditDialogVisible=!1,this.init()},closeFilterDialog:function(){this.filterDialogVisible=!1},addDrive:function(){Object.assign(this.driveItem,this.$options.data().driveItem),this.driveItem.id=null,this.driveEditDialogVisible=!0,console.log(this.supportStrategy)},init:function(){var e=this;this.$http.get("admin/support-strategy").then((function(t){e.supportStrategy=t.data.data})),this.$http.get("admin/drives").then((function(t){var n=t.data.data;for(var a in n)n[a].type=n[a].type.key;e.driveList=t.data.data}))}},mounted:function(){this.init(),this.setSort()}},Vt=Yt,Ht=(n("9a9b"),Object($t["a"])(Vt,a,i,!1,null,"4162da7e",null));t["default"]=Ht.exports},"8d57":function(e,t,n){"use strict";n("6aec")},9133:function(e,t,n){},"95db":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-card",{attrs:{shadow:"false"}},[n("markdown-render",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"scroll",attrs:{"element-loading-text":"拼命加载中",text:e.md}})],1)},i=[],o=n("f786"),r={name:"API",components:{MarkdownRender:o["a"]},data:function(){return{loading:!0,md:""}},mounted:function(){var e=this,t="https://c.jun6.net/ZFILE/ZFILE API.md";this.$http.get(t,{withCredentials:!1}).then((function(t){e.loading=!1,e.md=t.data})).catch((function(){e.$http.get("common/content",{params:{url:t}}).then((function(t){e.loading=!1,e.md=t.data.data}))}))}},s=r,l=(n("432e"),n("5d22")),c=Object(l["a"])(s,a,i,!1,null,"fad21930",null);t["default"]=c.exports},"9a9b":function(e,t,n){"use strict";n("c142")},adf4:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"zfile-admin-index"},[n("div",{staticClass:"zfile-admin-top"},[n("div",{staticClass:"zfile-admin-top-content"},[n("div",{staticClass:"zfile-admin-top-logo box animate__animated animate__fadeInLeft"},[n("el-popover",{attrs:{placement:"top-start",width:"200",trigger:"hover"}},[e.latestInfo?n("div",{staticClass:"zfile-admin-index-version-info"},[n("div",{domProps:{innerHTML:e._s("最新版：v"+e.latestInfo.tag_name)}}),n("div",{domProps:{innerHTML:e._s("发布时间: "+e.common.dateFormat(e.latestInfo.published_at))}}),n("br"),e._v("\n\n                        文档地址："),n("el-link",{staticClass:"zfile-word-aux zfile-margin-left-unset",attrs:{href:"http://docs.zhaojun.im/zfile",target:"_blank"}},[e._v("点击进入")]),n("br"),e._v("\n                        后端源码地址："),n("el-link",{staticClass:"zfile-word-aux zfile-margin-left-unset",attrs:{href:"https://github.com/zhaojun1998/zfile",target:"_blank"}},[e._v("点击进入")]),n("br"),e._v("\n                        前端源码地址："),n("el-link",{staticClass:"zfile-word-aux zfile-margin-left-unset",attrs:{href:"https://github.com/zhaojun1998/zfile-vue",target:"_blank"}},[e._v("点击进入")])],1):e._e(),n("div",{attrs:{slot:"reference"},domProps:{innerHTML:e._s("ZFile Admin v"+e.common.version)},on:{click:e.openZFileAdmin},slot:"reference"})])],1),n("el-menu",{staticClass:"zfile-admin-menu box animate__animated animate__fadeInDown",attrs:{mode:"horizontal","background-color":"#001529","text-color":"hsla(0,0%,100%,.65)","active-text-color":"#fff","default-active":"/admin"!==this.$route.path?this.$route.path:"/admin/site",router:!0},on:{select:e.rebuildTitle}},[n("el-menu-item",{attrs:{index:"/admin/site"}},[n("i",{staticClass:"el-icon-setting"}),n("span",{attrs:{slot:"title",id:"/admin/site"},slot:"title"},[e._v("基本设置")])]),n("el-menu-item",{attrs:{index:"/admin/drive-list"}},[n("i",{staticClass:"el-icon-folder-opened"}),n("span",{attrs:{slot:"title",id:"/admin/drive-list"},slot:"title"},[e._v("驱动器列表")])]),n("el-menu-item",{attrs:{index:"/admin/view"}},[n("i",{staticClass:"el-icon-view"}),n("span",{attrs:{slot:"title",id:"/admin/view"},slot:"title"},[e._v("显示设置")])]),n("el-menu-item",{attrs:{index:"/admin/password"}},[n("i",{staticClass:"el-icon-key"}),n("span",{attrs:{slot:"title",id:"/admin/password"},slot:"title"},[e._v("修改密码")])]),n("el-menu-item",{attrs:{index:"/admin/short-link"}},[n("i",{staticClass:"el-icon-link"}),n("span",{attrs:{slot:"title",id:"/admin/short-link"},slot:"title"},[e._v("短链管理")])]),n("el-menu-item",{on:{click:e.logDownload}},[n("i",{staticClass:"el-icon-download"}),n("span",{attrs:{slot:"title"},slot:"title"},[e._v("日志下载")])]),n("el-menu-item",{on:{click:e.click}},[n("i",{staticClass:"el-icon-s-home"}),n("span",{attrs:{slot:"title"},slot:"title"},[e._v("前往首页")])]),n("el-menu-item",{on:{click:e.logout}},[n("i",{staticClass:"el-icon-switch-button"}),n("span",{attrs:{slot:"title"},slot:"title"},[e._v("注销")])])],1)],1)]),n("div",{staticClass:"zfile-admin-content"},[n("keep-alive",{attrs:{exclude:"CacheManager,SiteSetting"}},[n("router-view",{staticClass:"zfile-admin-content-view box animate__animated animate__fadeIn"})],1)],1)])},i=[],o={name:"Index",data:function(){return{latestInfo:{},active:"/admin/site"}},methods:{logout:function(){var e=this;this.$http.get("logout").then((function(){e.$router.push("/login")}))},rebuildTitle:function(e){document.title=document.getElementById(e).innerText+" | 后台管理"},logDownload:function(){window.open(this.$http.defaults.baseURL+"/admin/log","_blank")},click:function(){window.open("/","_blank")},openZFileAdmin:function(){window.open("https://github.com/zhaojun1998/zfile")}},mounted:function(){var e=this,t=document.getElementsByClassName("is-active")[0].getElementsByTagName("span")[0].id;this.rebuildTitle(t),this.$http.get("https://api.github.com/repos/zhaojun1998/zfile/releases/latest",{withCredentials:!1,showMessage:!1}).then((function(t){e.latestInfo=t.data}))}},r=o,s=(n("bfe1"),n("5d22")),l=Object(s["a"])(r,a,i,!1,null,"158be3bf",null);t["default"]=l.exports},b8a6:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-card",{attrs:{shadow:"false"}},[n("el-form",{ref:"form",attrs:{id:"pwdForm",rules:e.rules,model:e.form,"label-width":"auto","status-icon":!0},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitForm("form")}}},[n("el-form-item",{staticClass:"box animate__animated animate__fadeInUp",attrs:{label:"管理员账号",prop:"username"}},[n("el-input",{model:{value:e.form.username,callback:function(t){e.$set(e.form,"username","string"===typeof t?t.trim():t)},expression:"form.username"}})],1),n("el-form-item",{staticClass:"box animate__animated animate__fadeInUp",attrs:{label:"设置新密码",prop:"password"}},[n("el-input",{model:{value:e.form.password,callback:function(t){e.$set(e.form,"password","string"===typeof t?t.trim():t)},expression:"form.password"}})],1),n("el-form-item",{staticClass:"box animate__animated animate__fadeInUp",attrs:{label:"确认密码",prop:"repassword"}},[n("el-input",{model:{value:e.form.repassword,callback:function(t){e.$set(e.form,"repassword","string"===typeof t?t.trim():t)},expression:"form.repassword"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("form")}}},[e._v("确认")])],1)],1)],1)},i=[],o=n("fed1"),r=n.n(o),s={name:"UpdatePassword",data:function(){var e=this;return{form:{username:"",password:"",repassword:""},rules:{username:[{required:!0,message:"请输入管理员账号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],repassword:[{required:!0,validator:function(t,n,a){""===n?a(new Error("请再次输入密码")):n!==e.form.password?a(new Error("两次输入密码不一致!")):a()},trigger:"change"}]}}},methods:{submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.$http.post("admin/update-pwd",r.a.stringify(t.form)).then((function(e){e.data.code===t.common.responseCode.SUCCESS&&t.$message({message:"保存成功",type:"success"})}))}))}},mounted:function(){var e=this;this.$http.get("admin/config").then((function(t){e.form=t.data.data}))}},l=s,c=n("5d22"),d=Object(c["a"])(l,a,i,!1,null,"2ac5b19c",null);t["default"]=d.exports},bfe1:function(e,t,n){"use strict";n("1e78")},c142:function(e,t,n){},c8c5:function(e,t,n){},e90a:function(e,t,n){},f10e:function(e,t,n){}}]);